<pre>
<tt>
<i><font color="#9A1900">/*</font></i>
<i><font color="#9A1900"> * SCORM-1.2 API-Adapter Java Applet for ILIAS</font></i>
<i><font color="#9A1900"> * Copyright (c) Matthai Kurian, Jan Gellweiler, Alexander Killing</font></i>
<i><font color="#9A1900"> *</font></i>
<i><font color="#9A1900"> * Made for ILIAS, the same license terms as for ILIAS itself apply.</font></i>
<i><font color="#9A1900"> *</font></i>
<i><font color="#9A1900"> * This Applet handles communication between ILIAS and SCORM-1.2</font></i>
<i><font color="#9A1900"> * Sharable Content Objects (SCOs). Most communication is via Liveconnect.</font></i>
<i><font color="#9A1900"> * CMI (Computer Managed Instruction) data is sent to ILIAS through http POST</font></i>
<i><font color="#9A1900"> * to an ILIAS server side PHP script. SCORM-1.2 runtime behavior and CMI</font></i>
<i><font color="#9A1900"> * datamodel management is done by the PfPLMS SCORM-1.2 API-Adapter Core. </font></i>
<i><font color="#9A1900"> */</font></i>

<b><font color="#000080">import</font></b> java<font color="#990000">.</font>util<font color="#990000">.</font>Hashtable<font color="#990000">;</font>
<b><font color="#000080">import</font></b> java<font color="#990000">.</font>util<font color="#990000">.</font>Enumeration<font color="#990000">;</font>
<b><font color="#000080">import</font></b> java<font color="#990000">.</font>net<font color="#990000">.</font><font color="#990000">*</font><font color="#990000">;</font>
<b><font color="#000080">import</font></b> java<font color="#990000">.</font>io<font color="#990000">.</font><font color="#990000">*</font><font color="#990000">;</font>

<b><font color="#0000FF">public</font></b>	<b><font color="#0000FF">class</font></b> IliasApiAdapterApplet
	<b><font color="#0000FF">extends</font></b> java<font color="#990000">.</font>applet<font color="#990000">.</font>Applet
	<b><font color="#0000FF">implements</font></b> ch<font color="#990000">.</font>ethz<font color="#990000">.</font>pfplms<font color="#990000">.</font>scorm<font color="#990000">.</font>api<font color="#990000">.</font>ApiAdapterInterface
<font color="#FF0000">{</font>
	<b><font color="#0000FF">private</font></b>	ch<font color="#990000">.</font>ethz<font color="#990000">.</font>pfplms<font color="#990000">.</font>scorm<font color="#990000">.</font>api<font color="#990000">.</font>ApiAdapter core<font color="#990000">;</font>

	<b><font color="#0000FF">private</font></b> Hashtable IliasScoCmi  <font color="#990000">=</font> <b><font color="#0000FF">new</font></b> <b><font color="#000000">Hashtable</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>

	<b><font color="#0000FF">private</font></b> String  IliasStudentId<font color="#990000">;</font>
	<b><font color="#0000FF">private</font></b> String  IliasStudentName<font color="#990000">;</font>
	<b><font color="#0000FF">private</font></b> String  IliasRefId<font color="#990000">;</font>
	<b><font color="#0000FF">private</font></b> String  IliasScoId<font color="#990000">;</font>
	<b><font color="#0000FF">private</font></b> String  IliasNextScoId<font color="#990000">;</font>

	<b><font color="#0000FF">private</font></b> <font color="#009900">boolean</font> IliasCredit <font color="#990000">=</font> <b><font color="#0000FF">false</font></b><font color="#990000">;</font>
	<b><font color="#0000FF">private</font></b> <font color="#009900">boolean</font> isLaunched  <font color="#990000">=</font> <b><font color="#0000FF">false</font></b><font color="#990000">;</font>
	<b><font color="#0000FF">private</font></b> <font color="#009900">boolean</font> isVerbose   <font color="#990000">=</font> <b><font color="#0000FF">false</font></b><font color="#990000">;</font>

	<b><font color="#0000FF">public</font></b> <b><font color="#000000">IliasApiAdapterApplet</font></b> <font color="#990000">(</font><font color="#990000">)</font> <font color="#FF0000">{</font>
		core <font color="#990000">=</font> <b><font color="#0000FF">new</font></b> ch<font color="#990000">.</font>ethz<font color="#990000">.</font>pfplms<font color="#990000">.</font>scorm<font color="#990000">.</font>api<font color="#990000">.</font><b><font color="#000000">ApiAdapter</font></b> <font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
	<font color="#FF0000">}</font>

	<b><font color="#0000FF">public</font></b>	<b><font color="#0000FF">final</font></b> <font color="#009900">void</font> <b><font color="#000000">init</font></b> <font color="#990000">(</font><font color="#990000">)</font> <font color="#FF0000">{</font>
		<i><font color="#9A1900">//if (getParameter("verbose") != null)</font></i>
		isVerbose <font color="#990000">=</font> <b><font color="#0000FF">true</font></b><font color="#990000">;</font>
		IliasRefId       <font color="#990000">=</font> <b><font color="#000000">getParameter</font></b> <font color="#990000">(</font><font color="#FF0000">"ref_id"</font><font color="#990000">)</font><font color="#990000">;</font>
		IliasStudentId   <font color="#990000">=</font> <b><font color="#000000">getParameter</font></b> <font color="#990000">(</font><font color="#FF0000">"student_id"</font><font color="#990000">)</font><font color="#990000">;</font>
		IliasStudentName <font color="#990000">=</font> <b><font color="#000000">getParameter</font></b> <font color="#990000">(</font><font color="#FF0000">"student_name"</font><font color="#990000">)</font><font color="#990000">;</font>
		<b><font color="#0000FF">if</font></b> <font color="#990000">(</font><b><font color="#000000">getParameter</font></b> <font color="#990000">(</font><font color="#FF0000">"credit"</font><font color="#990000">)</font> <font color="#990000">!</font><font color="#990000">=</font> <b><font color="#0000FF">null</font></b><font color="#990000">)</font> <font color="#FF0000">{</font>
			IliasCredit <font color="#990000">=</font> <b><font color="#0000FF">true</font></b><font color="#990000">;</font>
			<b><font color="#000000">say</font></b> <font color="#990000">(</font><font color="#FF0000">"cmi.core.credit=credit"</font><font color="#990000">)</font><font color="#990000">;</font>
		<font color="#FF0000">}</font>
		<b><font color="#000000">say</font></b> <font color="#990000">(</font><font color="#FF0000">"cmi.core.student_id="</font> <font color="#990000">+</font>IliasStudentId<font color="#990000">)</font><font color="#990000">;</font>
		<b><font color="#000000">say</font></b> <font color="#990000">(</font><font color="#FF0000">"cmi.core.student_name="</font> <font color="#990000">+</font>IliasStudentName<font color="#990000">)</font><font color="#990000">;</font>
	<font color="#FF0000">}</font>

	<b><font color="#0000FF">private</font></b> <b><font color="#0000FF">final</font></b> <font color="#009900">void</font> <b><font color="#000000">say</font></b> <font color="#990000">(</font>String s<font color="#990000">)</font> <font color="#FF0000">{</font>
		<b><font color="#0000FF">if</font></b> <font color="#990000">(</font>isVerbose<font color="#990000">)</font> System<font color="#990000">.</font>out<font color="#990000">.</font><b><font color="#000000">println</font></b> <font color="#990000">(</font>s<font color="#990000">)</font><font color="#990000">;</font>
	<font color="#FF0000">}</font>

	<b><font color="#0000FF">private</font></b> <b><font color="#0000FF">final</font></b> <font color="#009900">void</font> <b><font color="#000000">IliasLaunchContent</font></b> <font color="#990000">(</font>String s<font color="#990000">)</font> <font color="#FF0000">{</font>
		<b><font color="#0000FF">try</font></b> <font color="#FF0000">{</font>
			<b><font color="#000000">getAppletContext</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">.</font><b><font color="#000000">showDocument</font></b> <font color="#990000">(</font>
				<b><font color="#0000FF">new</font></b> <b><font color="#000000">URL</font></b><font color="#990000">(</font><b><font color="#000000">getCodeBase</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">+</font>s<font color="#990000">)</font><font color="#990000">,</font>
				<font color="#FF0000">"scorm_content"</font>
			<font color="#990000">)</font><font color="#990000">;</font>
		<font color="#FF0000">}</font> <b><font color="#0000FF">catch</font></b> <font color="#990000">(</font>Exception e<font color="#990000">)</font> <font color="#FF0000">{</font><font color="#FF0000">}</font>
	<font color="#FF0000">}</font>

	<b><font color="#0000FF">public</font></b>	<b><font color="#0000FF">final</font></b> <font color="#009900">void</font> <b><font color="#000000">IliasLaunchSco</font></b> <font color="#990000">(</font>String sco_id<font color="#990000">)</font> <font color="#FF0000">{</font>
		<b><font color="#0000FF">if</font></b> <font color="#990000">(</font>isLaunched <font color="#990000">&amp;</font><font color="#990000">&amp;</font> sco_id<font color="#990000">.</font><b><font color="#000000">equals</font></b><font color="#990000">(</font>IliasScoId<font color="#990000">)</font><font color="#990000">)</font> <font color="#FF0000">{</font>
			<b><font color="#000000">say</font></b> <font color="#990000">(</font><font color="#FF0000">"SCO "</font> <font color="#990000">+</font>sco_id <font color="#990000">+</font><font color="#FF0000">" is already running."</font><font color="#990000">)</font><font color="#990000">;</font>
			<b><font color="#0000FF">return</font></b><font color="#990000">;</font>
		<font color="#FF0000">}</font>
		IliasScoCmi<font color="#990000">.</font><b><font color="#000000">clear</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
		<b><font color="#000000">say</font></b> <font color="#990000">(</font><font color="#FF0000">"Launching sco "</font> <font color="#990000">+</font>sco_id<font color="#990000">)</font><font color="#990000">;</font>
		<b><font color="#0000FF">if</font></b> <font color="#990000">(</font>isLaunched<font color="#990000">)</font> <b><font color="#000000">say</font></b> <font color="#990000">(</font><font color="#FF0000">"Sco "</font><font color="#990000">+</font>IliasScoId <font color="#990000">+</font><font color="#FF0000">" will be unloaded."</font><font color="#990000">)</font><font color="#990000">;</font>
		isLaunched <font color="#990000">=</font> <b><font color="#0000FF">false</font></b><font color="#990000">;</font>
		<b><font color="#000000">IliasLaunchContent</font></b> <font color="#990000">(</font>
			<font color="#FF0000">"../scorm_presentation.php?cmd=launchSco"</font>
			<font color="#990000">+</font><font color="#FF0000">"&amp;sco_id="</font> <font color="#990000">+</font> sco_id
			<font color="#990000">+</font><font color="#FF0000">"&amp;ref_id="</font> <font color="#990000">+</font> IliasRefId
		<font color="#990000">)</font><font color="#990000">;</font>
		IliasNextScoId <font color="#990000">=</font> sco_id<font color="#990000">;</font>
	<font color="#FF0000">}</font>

	<b><font color="#0000FF">public</font></b>	<b><font color="#0000FF">final</font></b> <font color="#009900">void</font> <b><font color="#000000">IliasSetValue</font></b> <font color="#990000">(</font>String l<font color="#990000">,</font> String r<font color="#990000">)</font> <font color="#FF0000">{</font>
		<b><font color="#0000FF">if</font></b> <font color="#990000">(</font>r <font color="#990000">=</font><font color="#990000">=</font> <b><font color="#0000FF">null</font></b><font color="#990000">)</font> r <font color="#990000">=</font> <font color="#FF0000">""</font><font color="#990000">;</font> <i><font color="#9A1900">// MSIE bug</font></i>
		<b><font color="#000000">say</font></b> <font color="#990000">(</font><font color="#FF0000">"IliasSetValue("</font><font color="#990000">+</font>l<font color="#990000">+</font><font color="#FF0000">"="</font><font color="#990000">+</font>r<font color="#990000">+</font><font color="#FF0000">")"</font><font color="#990000">)</font><font color="#990000">;</font>
		<b><font color="#0000FF">if</font></b> <font color="#990000">(</font>l <font color="#990000">!</font><font color="#990000">=</font> <b><font color="#0000FF">null</font></b><font color="#990000">)</font> IliasScoCmi<font color="#990000">.</font><b><font color="#000000">put</font></b> <font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font><font color="#990000">;</font>
	<font color="#FF0000">}</font>

	<b><font color="#0000FF">private</font></b>	<b><font color="#0000FF">final</font></b> <font color="#009900">void</font> <b><font color="#000000">IliasInitialize</font></b> <font color="#990000">(</font><font color="#990000">)</font> <font color="#FF0000">{</font>
		core<font color="#990000">.</font><b><font color="#000000">sysPut</font></b> <font color="#990000">(</font><font color="#FF0000">"cmi.core.student_id"</font><font color="#990000">,</font>   IliasStudentId<font color="#990000">)</font><font color="#990000">;</font>
		core<font color="#990000">.</font><b><font color="#000000">sysPut</font></b> <font color="#990000">(</font><font color="#FF0000">"cmi.core.student_name"</font><font color="#990000">,</font> IliasStudentName<font color="#990000">)</font><font color="#990000">;</font>
		<b><font color="#0000FF">if</font></b> <font color="#990000">(</font>IliasCredit<font color="#990000">)</font> <font color="#FF0000">{</font>
			core<font color="#990000">.</font><b><font color="#000000">sysPut</font></b> <font color="#990000">(</font><font color="#FF0000">"cmi.core.credit"</font><font color="#990000">,</font> <font color="#FF0000">"credit"</font><font color="#990000">)</font><font color="#990000">;</font>
			core<font color="#990000">.</font><b><font color="#000000">sysPut</font></b> <font color="#990000">(</font><font color="#FF0000">"cmi.core.lesson_mode"</font><font color="#990000">,</font> <font color="#FF0000">"normal"</font><font color="#990000">)</font><font color="#990000">;</font>
		<font color="#FF0000">}</font>
		core<font color="#990000">.</font><b><font color="#000000">sysPut</font></b> <font color="#990000">(</font>IliasScoCmi<font color="#990000">)</font><font color="#990000">;</font>
		core<font color="#990000">.</font><b><font color="#000000">transBegin</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
		IliasScoId <font color="#990000">=</font> IliasNextScoId<font color="#990000">;</font>
		isLaunched <font color="#990000">=</font> <b><font color="#0000FF">true</font></b><font color="#990000">;</font>
	<font color="#FF0000">}</font>

	<b><font color="#0000FF">private</font></b> <b><font color="#0000FF">final</font></b> String <b><font color="#000000">IliasCommit</font></b> <font color="#990000">(</font><font color="#990000">)</font> <font color="#FF0000">{</font>
		<b><font color="#0000FF">if</font></b> <font color="#990000">(</font>IliasScoId <font color="#990000">=</font><font color="#990000">=</font> <b><font color="#0000FF">null</font></b><font color="#990000">)</font> <b><font color="#0000FF">return</font></b> <font color="#FF0000">"false"</font><font color="#990000">;</font>

		core<font color="#990000">.</font><b><font color="#000000">transEnd</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
		StringBuffer P <font color="#990000">=</font> <b><font color="#0000FF">new</font></b> <b><font color="#000000">StringBuffer</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
		Hashtable ins <font color="#990000">=</font> core<font color="#990000">.</font><b><font color="#000000">getTransNew</font></b> <font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
		Hashtable mod <font color="#990000">=</font> core<font color="#990000">.</font><b><font color="#000000">getTransMod</font></b> <font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
		core<font color="#990000">.</font><b><font color="#000000">transBegin</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>

		<font color="#009900">int</font> i<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font>
		<b><font color="#0000FF">for</font></b> <font color="#990000">(</font>Enumeration e <font color="#990000">=</font> ins<font color="#990000">.</font><b><font color="#000000">keys</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font> e<font color="#990000">.</font><b><font color="#000000">hasMoreElements</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font> i<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> <font color="#FF0000">{</font>
			Object l <font color="#990000">=</font> e<font color="#990000">.</font><b><font color="#000000">nextElement</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
			Object r <font color="#990000">=</font> ins<font color="#990000">.</font><b><font color="#000000">get</font></b><font color="#990000">(</font>l<font color="#990000">)</font><font color="#990000">;</font>
			P<font color="#990000">.</font><b><font color="#000000">append</font></b><font color="#990000">(</font><font color="#FF0000">"&amp;iL["</font><font color="#990000">+</font>i<font color="#990000">+</font><font color="#FF0000">"]="</font><font color="#990000">+</font>l<font color="#990000">.</font><b><font color="#000000">toString</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">)</font><font color="#990000">;</font>
			P<font color="#990000">.</font><b><font color="#000000">append</font></b><font color="#990000">(</font><font color="#FF0000">"&amp;iR["</font><font color="#990000">+</font>i<font color="#990000">+</font><font color="#FF0000">"]="</font><font color="#990000">+</font>URLEncoder<font color="#990000">.</font><b><font color="#000000">encode</font></b><font color="#990000">(</font>r<font color="#990000">.</font><b><font color="#000000">toString</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">)</font><font color="#990000">)</font><font color="#990000">;</font>
		<font color="#FF0000">}</font>

		<font color="#009900">int</font> u<font color="#990000">=</font><font color="#993399">0</font><font color="#990000">;</font>
		<b><font color="#0000FF">for</font></b> <font color="#990000">(</font>Enumeration e <font color="#990000">=</font> mod<font color="#990000">.</font><b><font color="#000000">keys</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font> e<font color="#990000">.</font><b><font color="#000000">hasMoreElements</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font> u<font color="#990000">+</font><font color="#990000">+</font><font color="#990000">)</font> <font color="#FF0000">{</font>
			Object l <font color="#990000">=</font> e<font color="#990000">.</font><b><font color="#000000">nextElement</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
			Object r <font color="#990000">=</font> mod<font color="#990000">.</font><b><font color="#000000">get</font></b><font color="#990000">(</font>l<font color="#990000">)</font><font color="#990000">;</font>
			P<font color="#990000">.</font><b><font color="#000000">append</font></b><font color="#990000">(</font><font color="#FF0000">"&amp;uL["</font><font color="#990000">+</font>u<font color="#990000">+</font><font color="#FF0000">"]="</font><font color="#990000">+</font>l<font color="#990000">.</font><b><font color="#000000">toString</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">)</font><font color="#990000">;</font>
			P<font color="#990000">.</font><b><font color="#000000">append</font></b><font color="#990000">(</font><font color="#FF0000">"&amp;uR["</font><font color="#990000">+</font>u<font color="#990000">+</font><font color="#FF0000">"]="</font><font color="#990000">+</font>URLEncoder<font color="#990000">.</font><b><font color="#000000">encode</font></b><font color="#990000">(</font>r<font color="#990000">.</font><b><font color="#000000">toString</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">)</font><font color="#990000">)</font><font color="#990000">;</font>
		<font color="#FF0000">}</font>

		<b><font color="#0000FF">if</font></b> <font color="#990000">(</font>i <font color="#990000">=</font><font color="#990000">=</font> <font color="#993399">0</font> <font color="#990000">&amp;</font><font color="#990000">&amp;</font> u <font color="#990000">=</font><font color="#990000">=</font> <font color="#993399">0</font><font color="#990000">)</font> <font color="#FF0000">{</font>
			<b><font color="#000000">say</font></b> <font color="#990000">(</font><font color="#FF0000">"Nothing to do."</font><font color="#990000">)</font><font color="#990000">;</font>
			<b><font color="#0000FF">return</font></b> <font color="#FF0000">"true"</font><font color="#990000">;</font>
		<font color="#FF0000">}</font>

		HttpURLConnection po<font color="#990000">;</font>

		<b><font color="#0000FF">try</font></b> <font color="#FF0000">{</font>
			po <font color="#990000">=</font> <font color="#990000">(</font>HttpURLConnection<font color="#990000">)</font> <font color="#990000">(</font> <b><font color="#0000FF">new</font></b> java<font color="#990000">.</font>net<font color="#990000">.</font><b><font color="#000000">URL</font></b> <font color="#990000">(</font>
				<b><font color="#000000">getCodeBase</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">.</font><b><font color="#000000">toString</font></b><font color="#990000">(</font><font color="#990000">)</font>
				<font color="#990000">+</font> <font color="#FF0000">"../scorm_server.php"</font>
				<font color="#990000">+</font> <font color="#FF0000">"?cmd=store"</font> 
				<font color="#990000">+</font> <font color="#FF0000">"&amp;api=2"</font> 
				<font color="#990000">+</font> <font color="#FF0000">"&amp;user_id="</font><font color="#990000">+</font>IliasStudentId
				<font color="#990000">+</font> <font color="#FF0000">"&amp;sco_id="</font> <font color="#990000">+</font>IliasScoId
				<font color="#990000">+</font> <font color="#FF0000">"&amp;ref_id="</font> <font color="#990000">+</font>IliasRefId
			<font color="#990000">)</font><font color="#990000">)</font><font color="#990000">.</font><b><font color="#000000">openConnection</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>

			po<font color="#990000">.</font><b><font color="#000000">setRequestProperty</font></b> <font color="#990000">(</font>
				<font color="#FF0000">"Content-Type"</font><font color="#990000">,</font>
				<font color="#FF0000">"application/x-www-form-urlencoded"</font>
			<font color="#990000">)</font><font color="#990000">;</font>
			po<font color="#990000">.</font><b><font color="#000000">setRequestProperty</font></b> <font color="#990000">(</font>
				<font color="#FF0000">"Content-Length"</font><font color="#990000">,</font>
				Integer<font color="#990000">.</font><b><font color="#000000">toString</font></b> <font color="#990000">(</font>P<font color="#990000">.</font><b><font color="#000000">length</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">)</font>
			<font color="#990000">)</font><font color="#990000">;</font>
			po<font color="#990000">.</font><b><font color="#000000">setDoOutput</font></b> <font color="#990000">(</font><b><font color="#0000FF">true</font></b><font color="#990000">)</font><font color="#990000">;</font>
			po<font color="#990000">.</font><b><font color="#000000">setUseCaches</font></b> <font color="#990000">(</font><b><font color="#0000FF">false</font></b><font color="#990000">)</font><font color="#990000">;</font>
			po<font color="#990000">.</font><b><font color="#000000">setRequestMethod</font></b> <font color="#990000">(</font><font color="#FF0000">"POST"</font><font color="#990000">)</font><font color="#990000">;</font>
			po<font color="#990000">.</font><b><font color="#000000">setAllowUserInteraction</font></b> <font color="#990000">(</font><b><font color="#0000FF">false</font></b><font color="#990000">)</font><font color="#990000">;</font>

			OutputStream os <font color="#990000">=</font> po<font color="#990000">.</font><b><font color="#000000">getOutputStream</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
			<b><font color="#000000">say</font></b> <font color="#990000">(</font><font color="#FF0000">"post:"</font> <font color="#990000">+</font>P<font color="#990000">.</font><b><font color="#000000">toString</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">)</font><font color="#990000">;</font>
			os<font color="#990000">.</font><b><font color="#000000">write</font></b> <font color="#990000">(</font>P<font color="#990000">.</font><b><font color="#000000">toString</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">.</font><b><font color="#000000">getBytes</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">)</font><font color="#990000">;</font>
			os<font color="#990000">.</font><b><font color="#000000">close</font></b> <font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>

			DataInputStream r <font color="#990000">=</font> <b><font color="#0000FF">new</font></b> <b><font color="#000000">DataInputStream</font></b><font color="#990000">(</font>
				po<font color="#990000">.</font><b><font color="#000000">getInputStream</font></b> <font color="#990000">(</font><font color="#990000">)</font>
			<font color="#990000">)</font><font color="#990000">;</font>
			<b><font color="#0000FF">try</font></b> <font color="#FF0000">{</font>
				<b><font color="#000000">say</font></b> <font color="#990000">(</font>r<font color="#990000">.</font><b><font color="#000000">readUTF</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">)</font><font color="#990000">;</font>
				r<font color="#990000">.</font><b><font color="#000000">close</font></b> <font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
			<font color="#FF0000">}</font> <b><font color="#0000FF">catch</font></b> <font color="#990000">(</font>EOFException ok<font color="#990000">)</font> <font color="#FF0000">{</font><font color="#FF0000">}</font>

			<b><font color="#000000">say</font></b> <font color="#990000">(</font>i <font color="#990000">+</font><font color="#FF0000">" inserted."</font><font color="#990000">)</font><font color="#990000">;</font>
			<b><font color="#000000">say</font></b> <font color="#990000">(</font>u <font color="#990000">+</font><font color="#FF0000">" updated."</font><font color="#990000">)</font><font color="#990000">;</font>
			<b><font color="#0000FF">return</font></b> <font color="#FF0000">"true"</font><font color="#990000">;</font>

		<font color="#FF0000">}</font> <b><font color="#0000FF">catch</font></b> <font color="#990000">(</font>Exception e<font color="#990000">)</font> <font color="#FF0000">{</font>
			<b><font color="#000000">say</font></b> <font color="#990000">(</font><font color="#FF0000">"Ilias cmi storage failed."</font><font color="#990000">)</font><font color="#990000">;</font>
			<b><font color="#000000">say</font></b> <font color="#990000">(</font>e<font color="#990000">.</font><b><font color="#000000">toString</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">)</font><font color="#990000">;</font>
			<b><font color="#0000FF">return</font></b> <font color="#FF0000">"false"</font><font color="#990000">;</font>
		<font color="#FF0000">}</font>
	<font color="#FF0000">}</font>

	<b><font color="#0000FF">private</font></b>	<b><font color="#0000FF">final</font></b> <font color="#009900">void</font> <b><font color="#000000">IliasFinish</font></b> <font color="#990000">(</font><font color="#990000">)</font> <font color="#FF0000">{</font>
		<b><font color="#0000FF">if</font></b> <font color="#990000">(</font><font color="#990000">!</font>isLaunched<font color="#990000">)</font> <b><font color="#0000FF">return</font></b><font color="#990000">;</font>
		<b><font color="#000000">IliasCommit</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font> <i><font color="#9A1900">// Stupid "implicit commit"</font></i>
		<b><font color="#000000">IliasLaunchContent</font></b> <font color="#990000">(</font>
			<font color="#FF0000">"../scorm_presentation.php?cmd=view"</font>
			<font color="#990000">+</font><font color="#FF0000">"&amp;sco_id="</font> <font color="#990000">+</font> IliasScoId
			<font color="#990000">+</font><font color="#FF0000">"&amp;ref_id="</font> <font color="#990000">+</font> IliasRefId
			<font color="#990000">+</font><font color="#FF0000">"&amp;status="</font> <font color="#990000">+</font> core<font color="#990000">.</font><b><font color="#000000">sysGet</font></b> <font color="#990000">(</font><font color="#FF0000">"cmi.core.lesson_status"</font><font color="#990000">)</font>
			<font color="#990000">+</font><font color="#FF0000">"&amp;totime="</font> <font color="#990000">+</font> core<font color="#990000">.</font><b><font color="#000000">sysGet</font></b> <font color="#990000">(</font><font color="#FF0000">"cmi.core.total_time"</font><font color="#990000">)</font>
		<font color="#990000">)</font><font color="#990000">;</font>
		isLaunched <font color="#990000">=</font> <b><font color="#0000FF">false</font></b><font color="#990000">;</font>
	<font color="#FF0000">}</font>

	<i><font color="#9A1900">/*</font></i>
<i><font color="#9A1900">	 * Liveconnect interface methods for SCO</font></i>
<i><font color="#9A1900">	 */</font></i>

	<b><font color="#0000FF">public</font></b>	<b><font color="#0000FF">final</font></b> String <b><font color="#000000">LMSInitialize</font></b> <font color="#990000">(</font>String s<font color="#990000">)</font> <font color="#FF0000">{</font> 
		String rv <font color="#990000">=</font> core<font color="#990000">.</font><b><font color="#000000">LMSInitialize</font></b><font color="#990000">(</font>s<font color="#990000">)</font><font color="#990000">;</font>
		<b><font color="#000000">say</font></b> <font color="#990000">(</font><font color="#FF0000">"LMSInitialize("</font><font color="#990000">+</font>s<font color="#990000">+</font><font color="#FF0000">")="</font><font color="#990000">+</font>rv<font color="#990000">)</font><font color="#990000">;</font>
		<b><font color="#0000FF">if</font></b> <font color="#990000">(</font>rv<font color="#990000">.</font><b><font color="#000000">equals</font></b><font color="#990000">(</font><font color="#FF0000">"false"</font><font color="#990000">)</font><font color="#990000">)</font> <b><font color="#0000FF">return</font></b> rv<font color="#990000">;</font>
		core<font color="#990000">.</font><b><font color="#000000">reset</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
		rv <font color="#990000">=</font> core<font color="#990000">.</font><b><font color="#000000">LMSInitialize</font></b><font color="#990000">(</font>s<font color="#990000">)</font><font color="#990000">;</font>
		<b><font color="#000000">IliasInitialize</font></b> <font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
		<b><font color="#0000FF">return</font></b> rv<font color="#990000">;</font>
	<font color="#FF0000">}</font>

	<b><font color="#0000FF">public</font></b>	<b><font color="#0000FF">final</font></b> String <b><font color="#000000">LMSCommit</font></b> <font color="#990000">(</font>String s<font color="#990000">)</font> <font color="#FF0000">{</font>
		String rv <font color="#990000">=</font> core<font color="#990000">.</font><b><font color="#000000">LMSCommit</font></b><font color="#990000">(</font>s<font color="#990000">)</font><font color="#990000">;</font>
		<b><font color="#0000FF">if</font></b> <font color="#990000">(</font>rv<font color="#990000">.</font><b><font color="#000000">equals</font></b><font color="#990000">(</font><font color="#FF0000">"false"</font><font color="#990000">)</font><font color="#990000">)</font> <b><font color="#0000FF">return</font></b> rv<font color="#990000">;</font>
		rv <font color="#990000">=</font> <b><font color="#000000">IliasCommit</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font> 
		<b><font color="#000000">say</font></b> <font color="#990000">(</font><font color="#FF0000">"LMSCommit("</font><font color="#990000">+</font>s<font color="#990000">+</font><font color="#FF0000">")="</font><font color="#990000">+</font>rv<font color="#990000">)</font><font color="#990000">;</font>
		<b><font color="#0000FF">return</font></b> rv<font color="#990000">;</font>
	<font color="#FF0000">}</font>

	<b><font color="#0000FF">public</font></b>	<b><font color="#0000FF">final</font></b> String <b><font color="#000000">LMSFinish</font></b> <font color="#990000">(</font>String s<font color="#990000">)</font> <font color="#FF0000">{</font>
		String rv <font color="#990000">=</font> core<font color="#990000">.</font><b><font color="#000000">LMSFinish</font></b><font color="#990000">(</font>s<font color="#990000">)</font><font color="#990000">;</font>
		<b><font color="#000000">say</font></b> <font color="#990000">(</font><font color="#FF0000">"LMSFinish("</font><font color="#990000">+</font>s<font color="#990000">+</font><font color="#FF0000">")="</font><font color="#990000">+</font>rv<font color="#990000">)</font><font color="#990000">;</font>
		<b><font color="#0000FF">if</font></b> <font color="#990000">(</font>rv<font color="#990000">.</font><b><font color="#000000">equals</font></b><font color="#990000">(</font><font color="#FF0000">"false"</font><font color="#990000">)</font><font color="#990000">)</font> <b><font color="#0000FF">return</font></b> rv<font color="#990000">;</font>
		<b><font color="#000000">IliasFinish</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
		core<font color="#990000">.</font><b><font color="#000000">reset</font></b><font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
		<b><font color="#0000FF">return</font></b> rv<font color="#990000">;</font>
	<font color="#FF0000">}</font>

	<b><font color="#0000FF">public</font></b>	<b><font color="#0000FF">final</font></b> String <b><font color="#000000">LMSGetDiagnostic</font></b> <font color="#990000">(</font>String e<font color="#990000">)</font> <font color="#FF0000">{</font>
		String rv <font color="#990000">=</font> core<font color="#990000">.</font><b><font color="#000000">LMSGetDiagnostic</font></b> <font color="#990000">(</font>e<font color="#990000">)</font><font color="#990000">;</font>
		<b><font color="#000000">say</font></b> <font color="#990000">(</font><font color="#FF0000">"LMSGetDiagnostic("</font><font color="#990000">+</font>e<font color="#990000">+</font><font color="#FF0000">")="</font><font color="#990000">+</font>rv<font color="#990000">)</font><font color="#990000">;</font>
		<b><font color="#0000FF">return</font></b> rv<font color="#990000">;</font>
	<font color="#FF0000">}</font>

	<b><font color="#0000FF">public</font></b>	<b><font color="#0000FF">final</font></b> String <b><font color="#000000">LMSGetErrorString</font></b> <font color="#990000">(</font>String e<font color="#990000">)</font> <font color="#FF0000">{</font>
		String rv <font color="#990000">=</font> core<font color="#990000">.</font><b><font color="#000000">LMSGetErrorString</font></b> <font color="#990000">(</font>e<font color="#990000">)</font><font color="#990000">;</font>
		<b><font color="#000000">say</font></b> <font color="#990000">(</font><font color="#FF0000">"LMSGetErrorString("</font><font color="#990000">+</font>e<font color="#990000">+</font><font color="#FF0000">")="</font><font color="#990000">+</font>rv<font color="#990000">)</font><font color="#990000">;</font>
		<b><font color="#0000FF">return</font></b> rv<font color="#990000">;</font>
	<font color="#FF0000">}</font>

	<b><font color="#0000FF">public</font></b>	<b><font color="#0000FF">final</font></b> String <b><font color="#000000">LMSGetLastError</font></b> <font color="#990000">(</font><font color="#990000">)</font> <font color="#FF0000">{</font>
		String rv <font color="#990000">=</font> core<font color="#990000">.</font><b><font color="#000000">LMSGetLastError</font></b> <font color="#990000">(</font><font color="#990000">)</font><font color="#990000">;</font>
		<b><font color="#000000">say</font></b> <font color="#990000">(</font><font color="#FF0000">"LMSLastError()="</font><font color="#990000">+</font>rv<font color="#990000">)</font><font color="#990000">;</font>
		<b><font color="#0000FF">return</font></b> rv<font color="#990000">;</font>
	<font color="#FF0000">}</font>

	<b><font color="#0000FF">public</font></b>	<b><font color="#0000FF">final</font></b> String <b><font color="#000000">LMSGetValue</font></b> <font color="#990000">(</font>String l<font color="#990000">)</font> <font color="#FF0000">{</font>
		String rv <font color="#990000">=</font> core<font color="#990000">.</font><b><font color="#000000">LMSGetValue</font></b> <font color="#990000">(</font>l<font color="#990000">)</font><font color="#990000">;</font>
		<b><font color="#000000">say</font></b> <font color="#990000">(</font><font color="#FF0000">"LMSGetValue("</font><font color="#990000">+</font>l<font color="#990000">+</font><font color="#FF0000">")="</font><font color="#990000">+</font>rv<font color="#990000">)</font><font color="#990000">;</font>
		<b><font color="#0000FF">return</font></b> rv<font color="#990000">;</font>
	<font color="#FF0000">}</font>

	<b><font color="#0000FF">public</font></b>	<b><font color="#0000FF">final</font></b> String <b><font color="#000000">LMSSetValue</font></b> <font color="#990000">(</font>String l<font color="#990000">,</font> String r<font color="#990000">)</font> <font color="#FF0000">{</font>
		String rv <font color="#990000">=</font> core<font color="#990000">.</font><b><font color="#000000">LMSSetValue</font></b> <font color="#990000">(</font>l<font color="#990000">,</font> r<font color="#990000">)</font><font color="#990000">;</font>
		<b><font color="#000000">say</font></b> <font color="#990000">(</font><font color="#FF0000">"LMSSetValue("</font><font color="#990000">+</font>l<font color="#990000">+</font><font color="#FF0000">"="</font><font color="#990000">+</font>r<font color="#990000">+</font><font color="#FF0000">")="</font><font color="#990000">+</font>rv<font color="#990000">)</font><font color="#990000">;</font>
		<b><font color="#0000FF">return</font></b> rv<font color="#990000">;</font>
	<font color="#FF0000">}</font>
<font color="#FF0000">}</font>
</tt>
</pre>
