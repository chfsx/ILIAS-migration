<html>

<head>
<title>{TXT_FOOTNOTES}</title>
<link rel="stylesheet" type="text/css" href="{LOCATION_STYLESHEET}" />
</head>

<body>

<b>{TXT_FOOTNOTES}</b>

<form method="post" name="footnotes">
<ul>

<script>
	var foundf=0;
	for (i=0;i<opener.fussnoten.length;i++) 
	{
		j=i+1;
		if(opener.fussnoten[i]!="") {
			foundf++;
			document.write( "["+j+"]&nbsp;<input type='text' name='fn"+i+"' value=\""+opener.fussnoten[i].replace("\"","&quot;")+"\" size=40>");
			//document.write( "[<a href='#' onClick=\"if(confirm('{DELETE_QUESTION}')) {deleteFootnote("+i+");}\">X</a>]");
			document.write("<input type=\"button\" value=\"{BTN_DELETE}\" onClick=\"if(confirm('{DELETE_QUESTION}')) {deleteFootnote("+i+");}\" name=\"deletelink\">");
			document.write( "<input type='hidden' name='fnold"+i+"' value=\""+opener.fussnoten[i].replace("\"","&quot;")+"\">");
			document.write( "<br>");
		} else {
			document.write( "<input type='hidden' name='fn"+i+"' value=\""+opener.fussnoten[i].replace("\"","&quot;")+"\">");	
			document.write( "<input type='hidden' name='fnold"+i+"' value=\""+opener.fussnoten[i].replace("\"","&quot;")+"\">");
		}
		
	}
	
</script>

</ul>
<script>
if(foundf>0) document.write("<input type='button' value='{BTN_SUBMIT}' onClick='refreshFootnotes();'>");
</script>

</form>
	
<form name='form' >
<hr size=1>
{TXT_INSERT_NEW_FOOTNOTES}:<br>
<input type='text' size=30 style='width:100%' name='fn' onKeyUp="if (document.form.fn.value!='') document.form.savenew.disabled=false; else document.form.savenew.disabled=true; ">
<p>
<table cellspacing=0 cellpadding=0 width="100%">
	<tr>
		<td>
			<input 	name="savenew" disabled type='button' 
					value='{BTN_SUBMIT}' 
					onClick="opener.addFussnote(document.form.fn.value);
							 opener.refreshFootnotelist();
							 opener.editor.surroundHTML('<span class=&quot;footnote&quot; value=&quot;'+document.form.fn.value+'&quot;>['+opener.fnCount+']</span>','');
							 window.close();">
		</td>
		<td align=right>
			<input type='button' value='{BTN_CANCEL}' onClick='window.close();'>
		</td>
	</tr>
</table>
</form>

<script>
function refreshFootnotes() {

	TX = opener.editor.getHTML();

	for (i=0;i<opener.fussnoten.length;i++) 
	{
		fn = "document.footnotes.fn"+i+"";
		obj1 = eval(fn);
		fn = "document.footnotes.fnold"+i+"";
		obj2 = eval(fn);
		opener.fussnoten[i] = obj1.value;
		j = i+1;
		TX = TX.replace("<span class=\"footnote\" value=\""+obj2.value+"\">["+j+"]</span>","<span class=\"footnote\" value=\""+obj1.value+"\">["+j+"]</span>");
		TX = TX.replace("<span value=\""+obj2.value+"\" class=\"footnote\">["+j+"]</span>","<span class=\"footnote\" value=\""+obj1.value+"\">["+j+"]</span>");
		
	}
	opener.editor.setHTML(TX);
	opener.refreshFootnotelist();
	window.close();

}

function deleteFootnote(i) 
{
	TX = opener.editor.getHTML();
	
	j=i+1;
	TX = TX.replace("<span class=\"footnote\" value=\""+opener.fussnoten[i]+"\">["+j+"]</span>",opener.fussnoten[i]);
	TX = TX.replace("<span value=\""+opener.fussnoten[i]+"\" class=\"footnote\">["+j+"]</span>",opener.fussnoten[i]);
	
	of = new Array();
	for(j=0;j<opener.fussnoten.length;j++) 
	{
		//if (i!=j) of[of.length] = opener.fussnoten[j];
		if (i==j) opener.fussnoten[j]="";
	}
	//opener.fussnoten = of;
	//opener.fnCount = opener.fussnoten.length;
	
	opener.editor.setHTML(TX);
	opener.refreshFootnotelist();
	
	window.location = "lm_edit.php?cmd=popup&ptype=footnote";
	
	//window.close();
}

</script>

</body>
</html>
