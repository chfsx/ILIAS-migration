<?php
/* Copyright (c) 1998-2010 ILIAS open source, Extended GPL, see docs/LICENSE */

/**
* class ilRbacLog
*  Log changes in Rbac-related settings
*
* @author Jörg Lützenkirchen <luetzenkirchen@leifos.com>
*
* @version $Id: class.ilRbacReview.php 24262 2010-06-15 06:48:14Z nkrzywon $
*
* @ingroup ServicesAccessControl
*/
class ilRbacLog
{
	const EDIT_PERMISSIONS = 1;

	static public function add($action, $ref_id, array $diff)
	{
		global $ilUser, $ilDB;

		if(self::isValidAction($action))
	    {
			$ilDB->query("INSERT INTO rbac_log (user_id, created, ref_id, action, data)".
				" VALUES (".$ilDB->quote($ilUser->getId(), "integer").",".$ilDB->quote(time(), "integer").
				",".$ilDB->quote($ref_id, "integer").",".$ilDB->quote($action, "integer").
				",".$ilDB->quote(serialize($diff), "text").")");
			return true;
		}
		return false;
	}

	static protected function isValidAction($action)
    {
		if(in_array($action, array(self::EDIT_PERMISSIONS)))
		{
			return true;
		}
		return false;
	}
}

?>
