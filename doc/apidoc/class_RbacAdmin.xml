<?xml version="1.0"?><phpdoc><class name="RbacAdmin" extends="PEAR" undoc="false" access="private" package="rbac"><file>/home/pgabriel/public_html/ilias3/classes/class.rbacAdmin.php</file><doc><author email="smeyer@databay.de">Stefan Meyer</author><description>core functions for role based access control</description><shortdescription>Class RbacAdmin</shortdescription><version>$Id$&#x0a;&#x0a;@extends PEAR</version></doc><function name="RbacAdmin" undoc="false" access="public"><doc><parameter name="&amp;$dbhandle" type="object db">db-handler</parameter><return type="void"/><description/><shortdescription>Constructor</shortdescription></doc></function><function name="roleExists" undoc="false" access="public"><doc><parameter name="$a_title" type="string"/><return name="" type="int"/><description/><shortdescription>Checks if a role already exists. Role title should be unique</shortdescription></doc></function><function name="addUser" undoc="false" access="public"><doc><parameter name="$a_data" type="array"/><return name="" type="boolean"/><description/><shortdescription>Inserts userdata in user_data table</shortdescription></doc></function><function name="deleteUser" undoc="false" access="public"><doc><parameter name="$a_usr_id" type="array"/><return name="" type="boolean"/><description/><shortdescription>Deletes a user from object_data, rbac_pa, rbac_ua and user_data</shortdescription></doc></function><function name="updateUser" undoc="false" access="public"><doc><parameter name="$a_userdata" type="array">user data</parameter><return name="" type="boolean"/><description/><shortdescription>updates user data in table user_data &amp; object_data</shortdescription></doc></function><function name="addRole" undoc="false" access="public"><doc><parameter name="$a_title" type="string"/><parameter name="$a_description" type="string"/><return name="" type="integer">new obj_id</return><description/><shortdescription>Creates a role, inserts data in object_data, rbac_ua, rbac_pa</shortdescription></doc></function><function name="deleteRole" undoc="false" access="public"><doc><parameter name="$a_obj_id" type="integer">Id</parameter><return name="" type="boolean"/><description/><shortdescription>Deletes a role and deletes entries in object_data, rbac_pa, rbac_templates, rbac_ua, rbac_fa</shortdescription></doc></function><function name="deleteTemplate" undoc="false" access="public"><doc><parameter name="$a_obj_id" type="integer">Id</parameter><parameter name="$a_parent" type="integer">Id</parameter><return name="" type="boolean"/><description/><shortdescription>Deletes a template from role folder and deletes all entries in object_data, rbac_templates, rbac_fa</shortdescription></doc></function><function name="deleteLocalRole" undoc="false" access="public"><doc><parameter name="$a_rol_id" type="integer">Id of role</parameter><parameter name="$a_parent" type="integer">of parent object</parameter><return name="" type="boolean"/><description/><shortdescription>Deletes a local role and entries in rbac_fa and rbac_templates</shortdescription></doc></function><function name="getParentRoles" undoc="false" access="public"><doc><parameter name="$a_path" type="array">Id</parameter><parameter name="$a_templates" default="false" type="boolean"/><return name="" type="boolean"/><description>it delivers also all templates in the path</description><shortdescription>Get parent roles in a path. If last parameter is set &amp;apos;true&amp;apos;</shortdescription></doc></function><function name="assignUser" undoc="false" access="public"><doc><parameter name="$a_rol_id" type="integer">id of role</parameter><parameter name="$a_usr_id" default="0" type="integer">id of user</parameter><return name="" type="boolean"/><description/><shortdescription>Assigns a user to a role</shortdescription></doc></function><function name="deassignUser" undoc="false" access="public"><doc><parameter name="$a_rol_id" type="integer">id of role</parameter><parameter name="$a_usr_id" type="integer">id</parameter><return name="" type="boolean"/><description/><shortdescription>Deassigns a user from a role</shortdescription></doc></function><function name="grantPermission" undoc="false" access="public"><doc><parameter name="$a_rol_id" type="integer">id of role</parameter><parameter name="$a_ops_id" type="array">of operations</parameter><parameter name="$a_obj_id" type="integer">id</parameter><parameter name="$a_setid" type="integer">id of parent object</parameter><return name="" type="boolean"/><description/><shortdescription>Grants permissions to an object</shortdescription></doc></function><function name="revokePermission" undoc="false" access="public"><doc><parameter name="$a_obj_id" type="integer">id</parameter><parameter name="$a_rol_id" default="&amp;quot;&amp;quot;" type="string">id</parameter><parameter name="$a_set_id" default="&amp;quot;&amp;quot;" type="string">of parent object</parameter><return name="" type="boolean"/><description/><shortdescription>Revokes permissions of object</shortdescription></doc></function><function name="getRolePermission" undoc="false" access="public"><doc><parameter name="$a_rol_id" type="integer">id</parameter><parameter name="$a_type" type="string"/><parameter name="$a_parent" type="integer"/><return name="" type="array">Operation ids</return><description/><shortdescription>Return template permissions of an role</shortdescription></doc></function><function name="copyRolePermission" undoc="false" access="public"><doc><parameter name="$a_rol_id" type="integer">id source</parameter><parameter name="$a_from" type="integer">id source</parameter><parameter name="$a_to" type="integer">id destination</parameter><parameter name="$a_dest_rol_id" default="&amp;apos;&amp;apos;" type="string">id destination</parameter><return name="" type="boolean"/><description/><shortdescription>Copies template permissions</shortdescription></doc></function><function name="deleteRolePermission" undoc="false" access="public"><doc><parameter name="$a_rol_id" type="integer">id</parameter><parameter name="$a_parent" type="integer">object id</parameter><return name="" type="boolean"/><description/><shortdescription>Deletes a template</shortdescription></doc></function><function name="setRolePermission" undoc="false" access="public"><doc><parameter name="$a_rol_id" type="integer">id</parameter><parameter name="$a_type" type="string"/><parameter name="$a_ops_id" type="array">ids</parameter><parameter name="$a_parent" type="object id"/><return name="" type="boolean"/><description/><shortdescription>Inserts template permissions in rbac_templates</shortdescription></doc></function><function name="getSetIdByObject" undoc="false" access="public"><doc><parameter name="$a_obj_id" type="integer">id</parameter><return name="" type="array">parent ids</return><description/><shortdescription>Returns parent id of an object (obsolete)</shortdescription></doc></function><function name="getRoleListByObject" undoc="false" access="public"><doc><parameter name="$a_parent" type="integer">id</parameter><parameter name="$a_order" default="&amp;apos;&amp;apos;" type="string"/><parameter name="$a_direction" default="&amp;apos;&amp;apos;" type="string"/><return name="" type="array">set ids</return><description/><shortdescription>Returns a list of roles in an container</shortdescription></doc></function><function name="getRoleAndTemplateListByObject" undoc="false" access="public"><doc><parameter name="$a_parent" type="integer">id</parameter><parameter name="$a_order" default="&amp;apos;&amp;apos;" type="string"/><parameter name="$a_direction" default="&amp;apos;&amp;apos;" type="string"/><return name="" type="array">set ids</return><description/><shortdescription>Returns a list of roles  and templates of an container</shortdescription></doc></function><function name="assignRoleToFolder" undoc="false" access="public"><doc><parameter name="$a_rol_id" type="integer">id of role</parameter><parameter name="$a_parent" type="integer">object id</parameter><parameter name="$a_assign" default="&amp;apos;y&amp;apos;" type="string">(&amp;apos;y&amp;apos;,&amp;apos;n&amp;apos;)</parameter><return name="" type="boolean"/><description/><shortdescription>Assigns a role to an role folder</shortdescription></doc></function><function name="isAssignable" undoc="false" access="public"><doc><parameter name="$a_rol_id" type="integer">id</parameter><parameter name="$a_parent" type="integer">id</parameter><return name="" type="boolean"/><description/><shortdescription>Check if its possible to assign users</shortdescription></doc></function><function name="getRoleData" undoc="false" access="public"><doc><parameter name="$a_obj_id" type="integer">id</parameter><return name="" type="array">array of set ids</return><description/><shortdescription>gets data of an role</shortdescription></doc></function><function name="getFoldersAssignedToRole" undoc="false" access="public"><doc><parameter name="$a_rol_id" type="integer">id</parameter><return name="" type="array">object ids of role folders</return><description/><shortdescription>returns an array with role ids assigned to a role folder</shortdescription></doc></function><function name="getRolesAssignedToFolder" undoc="false" access="public"><doc><parameter name="$a_parent" type="integer">id</parameter><return name="" type="array">Array with rol_ids</return><description/><shortdescription>return an array with role ids</shortdescription></doc></function><function name="getRoleFolder" undoc="false" access="public"><doc><return name="" type="array"/><description/><shortdescription>all role folder ids</shortdescription></doc></function><function name="getRoleFolderOfObject" undoc="false" access="public"><doc><parameter name="$a_parent" type="integer">id</parameter><return name="" type="array"/><description/><shortdescription>returns the data of a role folder assigned to an object</shortdescription></doc></function><function name="getParentObject" undoc="false" access="public"><doc><parameter name="$a_child" type="integer"/><return name="" type="integer"/><description/><shortdescription>return id of parent object</shortdescription></doc></function><function name="getOperationsOnType" undoc="false" access="public"><doc><parameter name="$a_typ_id" type="integer"/><return name="" type="array"/><description/><shortdescription>all possible operations of a type</shortdescription></doc></function><function name="getParentRoleIds" undoc="false" access="private"><doc><parameter name="$a_start_node" default="0" type="integer">id of start node</parameter><parameter name="$a_start_parent" default="0" type="integer">id of start parent</parameter><parameter name="$a_templates" default="false" type="boolean"/><return name="" type="string"/><description>you get also all parent templates</description><shortdescription>get role ids of all parent roles, if last parameter is set true</shortdescription></doc></function><function name="RbacAdminH" undoc="false" access="private"><doc><parameter name="&amp;$dbhandle" type="object db"/><return type="void"/><description/><shortdescription>database handle</shortdescription></doc></function><function name="addInheritance" undoc="false" access="public"><doc><return type="void"/><description/><shortdescription/></doc></function><function name="deleteInheritance" undoc="false" access="public"><doc><return type="void"/><description/><shortdescription/></doc></function><function name="addAscendant" undoc="false" access="public"><doc><return type="void"/><description/><shortdescription/></doc></function><function name="addDescendant" undoc="false" access="public"><doc><return type="void"/><description/><shortdescription/></doc></function><variable name="$db" access="private" type="object db"><doc><description/><shortdescription>Database Handle</shortdescription></doc></variable><variable name="$error_class" access="private" type="object error_class"><doc><description/><shortdescription>error class</shortdescription></doc></variable></class></phpdoc>