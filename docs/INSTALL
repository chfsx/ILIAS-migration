                       ==================================
                        ILIAS open source - Installation
                       ==================================

          Author: Boris H. Schuermann
          Send any questions to loeffelholz@xh9.net (Wolf von Loeffelholz)
          $Id$



Table of Contents

1. Introduction

2. First time installation

   2.1 Where to install ILIAS

   2.2 First steps

   2.3 Installing required third-party software

       2.3.1 Libraries & utilities

       2.3.2 MySQL / PHP4 / Apache

   2.4 Installing ILIAS

       2.4.1 Installing ILIAS 2

       2.4.2 Installing ILIAS 3

   2.5 Installing optional third-party software

3. Software updates

   3.1 Updating ILIAS 2

   3.2 Updating ILIAS 3

   3.3 Updating third-party software

Appendix A: Note on using Apache 2

Appendix B: MySQL and Apache init scripts for RedHat




1. I N T R O D U C T I O N

ILIAS is a web-based Learning Content Managament System (LCMS) developed with
the server-side scripting language PHP and distributed as Open Source software
under the GNU General Public License (GPL). It uses the MySQL database and the
Apache web server. The main target operating system is Linux, but ILIAS may also
be run on other Unix systems and even Windows.

This document describes the installation of ILIAS 2 and ILIAS 3 with the all
software required for running an ILIAS system. The procedure has been tested
under RedHat Linux 7.x/8.0. With minor modifications it should also apply to
other Linux distributions, Solaris and other Unix systems.

The following third-party software is necessary for running ILIAS. Release
numbers refer to the version tested and recommended for use with ILIAS. Like
ILIAS itself, all these programs are available as Open Source software.

    - Apache 1.3.29            http://www.apache.org
    - MySQL 4.0.18             http://www.mysql.com
    - PHP 4.3.6                http://www.php.net
    - GD (libgd) 2.0.15        http://www.boutell.com/gd/
    - Zlib (libz) 1.1.4        http://www.gzip.org/zlib/
    - libpng 1.2.5             http://www.libpng.org
    - IJG JPEG (libjpeg) 6b    ftp://ftp.uu.net/graphics/jpeg/jpegsrc.v6b.tar.gz
    - ImageMagick 6.0.1        http://www.imagemagick.org
    - Info-ZIP (Zip/UnZip)     http://www.info-zip.org

For running ILIAS 3 additional software is required:

    - libxml2 2.6.9            http://www.xmlsoft.org
    - libxslt 1.1.6            http://www.xmlsoft.org
    - libexpat 1.95.7          http://www.libexpat.org
    - Sablotron 1.1            http://www.gingerall.com

The recommended releases can also be downloaded from the ILIAS open source web
site: http://www.ilias.uni-koeln.de/ios/source.html

Please see chapter 2.5 for information about optional software.

In this guide it is assumed that none of the programs above are installed on
your system. However, many Linux distributions install libraries and programs
such as libz, libgd, libjpeg, libgd, ImageMagick and Zip/Unzip by default. If
installed properly it might not be necessary to install these packages along
with ILIAS again.

If your installation of PHP, Apache or MySQL must meet additional requirements
or if you prefer different versions of these components, you may of course
configure the software yourself. Just make sure that your own configuration
supports all components used by ILIAS.

Prior to compilation your system should at least include the following programs:
gcc,, g++, GNU make, autoconf (>=2.13), automake (>= 1.4), libtool (>=1.4.3),
perl(>=5.0), gdbm, bison,(>=1.25), flex, GNU tar, libncurses.

Some functions in ILIAS require outgoing Internet mail. Therefore a sendmail
daemon should run on your system and outgoing connections should be allowed
on port 25.

General advices on compiling the software packages:

    - For better readability, long command lines are broken down to multiple
      lines. In this case, a backslash at the end of a line indicates that the
      next line is to be considered a continuation.
    - Please follow the installation steps in the given order. Some steps rely
      on previously issued commands.
    - If the configure/make process fails or gets interrupted, it is a good idea
      to remove the complete source directory of the program to be built and
      start a new attempt with a source directory freshly extracted from the
      corresponding tarball. In any case you should at least delete the file
      'config.cache' if it exists.
    - To facilitate installation you may use the Cut & Paste functions of your
      system to enter the commands in this document into your console. If you
      load this document into an editor capable of selecting colums such as
      'nedit' this may even work for entire command sequences with multiple
      lines separated by a backslash.



2  F I R S T   T I M E   I N S T A L L A T I O N


2.1 Where to install ILIAS

ILIAS will often be installed within an existing server environment. In this
case the administrator of such a system will have to make sure, that the web
server supports the PHP scripting language with all libraries required and that
it can interact with a MySQL database server.

The instructions herein assume that you do not have any of the software
packages required for running ILIAS installed on your server. Following them
all these programs will be built from their source code and then be installed
under /opt/ilias/. This way the programs will normally not interfere with
packages already installed on your system and can easily be removed.

Beside the third-party software also ILIAS itself and all data directories
(including the ILIAS web space, the MySQL databases, places for file uploads,
logfiles etc.) will be located under /opt/ilias/. For just trying out ILIAS
this solution is fine but if you intend to use ILIAS in a production environment
we recommend to seperate the program binaries from the user data, e.g. to
facilitate backup and administration tasks.

You could for instance install all third-party software under /opt/ilias/ and
create a directory /srv/ilias/ for the ILIAS web space and all other ILIAS
related data (except for logfiles which should ideally go to /var/log/ilias/).
The subdirectories under /srv/ilias/ could be the same as the ones which are
created under /opt/ilias/ during the installation process described in this
document. The /srv directory (which should be a mounted partition, as it could
swallow up your disk space and thus cause problems when being part of your
root partition) is not yet part of the Filesystem Hierarchy Standard (FHS) in
its current version 2.2. But there have been proposals to add it to the FHS and
some Linux distributions already use /srv/www as the default location for their
web space. Since standardization efforts are still going on, our recommendation
might be a temporary one.

When compiling the components necessary to run ILIAS from source you may easily
specify their installation location using an appropriate '--prefix' directive.
Library locations that you specify must also reflect your system environment. It
would be fine (and also in compliance with the FHS) to install everything
including the data directories under /usr/local. That is also the default
location where most source distributions will install themself in the build
process. Of course you may also use symbolic links to change the location of
the directories involved.

In many cases you may want to use binary packages like RPMs instead of compiling
the software yourself.  If these packages meet the requirements resulting from
the configure options in this document, this should normally work fine. You
would just have to put the ILIAS scripts into your web space and do some
adjustments to the Apache, PHP and MySQL configuration files as well as some of
the pathes in the ILIAS system settings.



2.2 First steps

If you choose to install ILIAS according to our recommendation, the directories
below need to be created manually:

Directories where third-party components will be located:

    mkdir /opt/ilias
    mkdir /opt/ilias/bin
    mkdir /opt/ilias/config
    mkdir /opt/ilias/include
    mkdir /opt/ilias/lib
    mkdir /opt/ilias/libexec
    mkdir /opt/ilias/man
    mkdir /opt/ilias/man/man1
    mkdir /opt/ilias/man/man5
    mkdir /opt/ilias/src
    mkdir /opt/ilias/src/tarballs

Directories for the ILIAS web space and all ILIAS related data:

    mkdir /opt/ilias/data
    mkdir /opt/ilias/log
    mkdir /opt/ilias/log/ilias
    mkdir /opt/ilias/mysqldata
    mkdir /opt/ilias/www

For running ILIAS 2 create the following additional data directories:

    mkdir /opt/ilias/data/files
    mkdir /opt/ilias/data/offline
    mkdir /opt/ilias/data/import
    mkdir /opt/ilias/data/export


Copy all source tar files to /opt/ilias/src/tarballs. GNU-Tar will extract the
source files into separate directories in /opt/ilias/src:

    cd /opt/ilias/src
    tar -xzf tarballs/zlib-1.1.4.tar.gz
    tar -xzf tarballs/jpegsrc.v6b.tar.gz
    tar -xzf tarballs/libpng-1.2.5.tar.gz
    tar -xzf tarballs/gd-2.0.15.tar.gz
    tar -xzf tarballs/ImageMagick-6.0.1-2.tar.gz
    tar -xzf tarballs/zip23.tar.gz
    tar -xzf tarballs/unzip550.tar.gz
    tar -xzf tarballs/mysql-4.0.18.tar.gz
    tar -xzf tarballs/apache_1.3.29.tar.gz
    tar -xzf tarballs/php-4.3.6.tar.gz

For running ILIAS 3 please also unpack the following files:

    tar -xzf tarballs/libxml2-2.6.9.tar.gz
    tar -xzf tarballs/libxslt-1.1.6.tar.gz
    tar -xzf tarballs/expat-1.95.7.tar.gz
    tar -xzf tarballs/Sablot-1.1.tar.gz

The ILIAS software, its documentation and the web space directory structure is
stored in:

    ilias-2.4.6.tar.gz

or for ILIAS 3 in:

    ilias-3.2.1.tar.gz

The ILIAS tarball may also reside in /opt/ilias/src/tarballs/. After all third-
party software has been installed it can directly be extracted into the web
space.



2.3 Installing required third-party software


2.3.1 Libraries & utilities

If not already available on your system, the following libraries and utilities
must be installed:

    - ZLib (libz, compression library required by various other programs)
    - GD-Library (libgd, graphics library used by PHP)
    - IJG JPEG-Library (libjpeg, graphics library used by ImageMagick)
    - libpng (PNG graphics library used by libgd and Imagemagick)
    - ImageMagick (graphics tool used by ILIAS for Image format conversion)
    - Info-ZIP (Zip/UnZip tools used for compressing offline courses)

For ILIAS 3 these additional packages are required:

    - libxml (GNOME XML library, required by PHP for XML DOM parsing. At least a
      version >= 2.4.14 is required)
    - libxslt (GNOME XSLT library, required by PHP for using DOM XSLT features)
    - Expat (XML parser used by the Sablotron XSLT processor)
    - Sablotron (XSLT processor)

The programs can be compiled and installed using the command sequences shown
below. However, you may decide to install them in different locations such
as /usr/lib or /usr/local/lib for the libaries by changing the configure option
--prefix.


(a) Zlib

        cd /opt/ilias/src/zlib-1.1.4
        ./configure --prefix=/opt/ilias
        make
        make install


(b) IJG JPEG-library

        cd /opt/ilias/src/jpeg-6b
        ./configure \
        --prefix=/opt/ilias \
        --enable-shared \
        --enable-static
        make
        make test
        make install


(c) libpng

    libpng does not come with a configure script. You have to pick a Makefile
    suitable for your system in the ./scripts subdirectory. In the following it
    is assumed that the target system is Linux.

    To install libpng under /opt/ilias the 'prefix' (default: /usr/local) in the
    Makefile must be changed. In addition the location of libz should be properly
    specified: 'ZLIBLIB=/opt/ilias/lib' and 'ZLIBINC=/opt/ilias/include'. Both
    settings can be changed manually with a text editor such as 'vi' or by using
    the 'sed' commands shown below.

        cd /opt/ilias/src/libpng-1.2.5

    Now you can either edit Makefile to adjust the prefix:

        cp scripts/makefile.linux Makefile
        vi Makefile

    or you can use 'sed' to directly create a modified Makefile:

        sed \
        -e 's/\/usr\/local/\/opt\/ilias/g' \
        -e 's/ZLIBLIB=..\/zlib/ZLIBLIB=\/opt\/ilias\/lib/g' \
        -e 's/ZLIBINC=..\/zlib/ZLIBINC=\/opt\/ilias\/include/g' \
        scripts/makefile.linux > Makefile

        make
        make install


(d) GD-Library

    From release 4.3.0 PHP comes with a bundled libgd. Like all standard libgd
    versions >= 1.6.x the bundled version does not allow the creation and
    manipulation of GIF images due to the patent problem concerning the use of
    the LZW algorithm.

    For most purposes the bundled libgd is sufficient since ILIAS does rely on
    GIF support by libgd anymore. A libgd supporting the GIF format would only
    be necessary if you intend to create clickable maps based on GIF files with
    the Imagemap editor being part of the ILIAS authoring tool.

    The patent on the LZW algorithm held by Unisys Corporation has already
    expired in the United States as well as in some other countries.(see
    http://www.unisys.com/about__unisys/lzw/ for details). So depending on where
    you live you may legally use a patched libgd with GIF support. Patched libgd
    are available from an Australian website: http://www.rime.com.au/gd/

    In case you want to build and use an external libgd please follow the steps
    below which also apply to patched versions:

        cd /opt/ilias/src/gd-2.0.15
        ./configure \
        --prefix=/opt/ilias \
        --with-jpeg=/opt/ilias \
        --with-png=/opt/ilias
        make
        make install

    Please note that opposed to current PHP versions some older PHP 4 releases
    cannot properly be compiled with newer libgd. A patch that solves the problem
    is available for PHP 4.2.3 and libgd >= 2.0.8 is available here:
    http://www.boutell.com/gd/phppatch.html

    You may also use an older libgd, for example version 1.8.4. The latter does
    not come with a configure script. To adapt it to your system you would have
    to modify its Makefile manually. In particular the INSTALL_ pathes may have
    to be adjusted.  Since libgd requires libz, libpng and libjpeg you may also
    have to specify the exact locations of these libraries in the LIBS= section
    of the Makefile (e.g. by entering '/opt/ilias/lib/libz.a' instead of '-lz').


(e) ImageMagick

        cd /opt/ilias/src/ImageMagick-6.0.1
        ./configure \
        --prefix=/opt/ilias \
        --without-perl \
        --enable-lzw \
        --enable-shared
        make
        make install

    If you do not have X installed on your system you must use the configure
    option '--without-x' in addition.

    At the end of the configure process a configuration summary is displayed.
    Please check if 'yes' is shown as the configured value for JPEG and PNG. If
    not, ImageMagick could probably not find the previously installed libjpeg
    and libpng and you may experience problems when doing image manipulations
    in ILIAS such as editing a clickable imagemap or when thumbnail pictures
    are being created.

    Note on building ImageMagick under SuSE Linux: The build process might
    fail with an error message claiming that the file 'byteorder.h' cannot be
    found in /usr/include/sys/. Under SuSE it is located in /usr/include/asm/.
    Creating a symbolic link will solve the problem:

        cd /usr/include/sys
        ln -s ../asm/byteorder.h byteorder.h


(f) Info-ZIP

        cd /opt/ilias/src/zip-2.3
        make -f unix/Makefile generic
        make -f unix/Makefile install
        cd /opt/ilias/src/unzip-5.50
        make -f unix/Makefile generic
        make -f unix/Makefile install

    By default Zip and Unzip will be installed in /usr/local/bin. As the zip and
    unzip tools are generelly helpful, you may put them there. Otherwise you may
    install them under /opt/ilias by modifying the Makefile.


The following steps are only necessary for running ILIAS 3:

(g) libxml

        cd /opt/ilias/src/libxml2-2.6.9
        ./configure \
        --prefix=/opt/ilias \
        --without-python
        make
        make install


(h) libxslt

        cd /opt/ilias/src/libxslt-1.1.6
        ./configure \
        --prefix=/opt/ilias \
        --with-libxml-prefix=/opt/ilias \
        --without-python
        make
        make install


(i) Expat

        cd /opt/ilias/src/expat-1.95.7
        ./configure --prefix=/opt/ilias
        make
        make install


(j) Sablotron

        cd /opt/ilias/src/Sablot-1.1
        ./configure \
        --prefix=/opt/ilias \
        --with-expat-prefix=/opt/ilias
        make
        make install



2.3.2 MySQL / PHP4 / Apache

After the libraries and tools are set up you may install the main third-party
components:


(a) MySQL database

    Configure & make:

        cd /opt/ilias/src/mysql-4.0.18
        ./configure \
        --prefix=/opt/ilias \
        --localstatedir=/opt/ilias/mysqldata \
        --sysconfdir=/opt/ilias/config
        make
        make install

    Now install MySQL's default databases:

        scripts/mysql_install_db

    Create link to init script:

        cd /opt/ilias/share/mysql
        chmod 744 mysql.server
        cp mysql.server /etc/rc.d/init.d/
        cd /etc/rc.d/rc3.d
        ln -s ../init.d/mysql.server S72mysql.server
        ln -s ../init.d/mysql.server K72mysql.server

    The directories containing the init script and the links to it may vary.
    Please check the default runlevel for your system in /etc/inittab. On
    Solaris systems the init scripts can usually be found in /etc/init.d, the
    links in the runlevel specific directories like /etc/rc3.d.

    If you are using RedHat Linux, the standard MySQL init script may not stop
    the MySQL daemon properly. Please see appendix A for a modified version
    using RedHat specific init functions. In RedHat you may use chkconfig --add
    to create the runlevel specific links automatically.

    It is recommended not to run the mysql daemon as root. The daemon user can
    be set in /etc/rc.d/init.d/mysql.server. On many Linux/Unix system you may
    create a daemon user account and group by entering:

        groupadd mysql
        useradd -g mysql mysql

    File ownership for /opt/ilias/mysqldata needs to be set accordingly:

        chown -R mysql /opt/ilias/mysqldata
        chgrp -R mysql /opt/ilias/mysqldata

    Create a MySQL configuration file and link to it:

        cd /opt/ilias/share/mysql
        cp my-small|medium|large|huge.cnf /opt/ilias/config/my.cnf
        cd /opt/ilias/mysqldata
        ln -s /opt/ilias/config/my.cnf

    MySQL version 4.0.x comes with sample configuration files for different
    memory sizes (small, medium, large, huge). Please select the appropriate
    file and apply further changes to /opt/ilias/config/my.cnf according to your
    specific needs. Since ILIAS currently does not rely on InnoDB support in
    MySQL you may disable it by adding the 'skip-innodb' option to the mysqld
    section of the my.cnf file.

    Create link to error log file:

        cd /opt/ilias/log
        ln -s /opt/ilias/mysqldata/$HOSTNAME.err

    If desired you may also redirect database logging from /opt/ilias/mysqldata
    (default) to /opt/ilias/log by modifying the log-bin (or log-update) option
    in my.cnf.

    Check if MySQL daemon can be started/stopped:

        /etc/rc.d/init.d/mysql.server start
        /etc/rc.d/init.d/mysql.server stop

    Please note that unless a password has been set for the MySQL root account,
    any user can start the MySQL client with all privileges. It is advisable to
    change the password for the root account using the follwing command:

        /opt/ilias/bin/mysqladmin -u root password <password>

    If you set a password for the MySQL root account you will have to modify the
    database settings for ILIAS. Please see section 2.4 for details. You might
    also consider using a dedicated MySQL account for running ILIAS instead of
    the MySQL root account.

    For MySQL 4.0 and higher you need to grant the permission LOCK TABLES to
    the ILIAS db-user. E.g. if the ILIAS db-user 'dbuser' accesses from host
    'localhost':

        /opt/ilias/bin/mysql -u root password <password>
        mysql> grant LOCK TABLES on *.* to dbuser@localhost;


(b) Apache (preparation)

        cd /opt/ilias/src/apache_1.3.29
        ./configure --prefix=/opt/ilias


(c) PHP

    Configure & make:

        cd /opt/ilias/src/php-4.3.6
        ./configure \
        --prefix=/opt/ilias \
        --with-apache=/opt/ilias/src/apache_1.3.29 \
        --with-config-file-path=/opt/ilias/config \
        --with-mysql=/opt/ilias \
        --with-zlib=/opt/ilias \
        --with-zlib-dir=/opt/ilias \
        --with-gd \
        --with-jpeg-dir=/opt/ilias \
        --with-png-dir=/opt/ilias
        make
        make install

    Newer PHP releases come with an integrated libgd which is activated by
    using the --with-gd directive. If you are using a version of PHP < 4.3.0 or
    want to build it with an external libgd you should specify the location of
    the libgd on your system, e.g. by entering '--with-gd=/opt/ilias'.

    For running ILIAS 3 the following configure options must be added:

        --with-dom=/opt/ilias
        --with-dom-xslt=/opt/ilias
        --enable-xslt
        --with-xslt-sablot=/opt/ilias
        --with-expat-dir=/opt/ilias
        --with-pear=/opt/ilias/lib/pear

    Note: If compilation/linking fails with a compile error concerning undefined
    references in 'libsablot.so' try to set the and LDFLAGS environment variable
    using the following (bash shell) command: export LDFLAGS='-lstdc++'

    ILIAS 3 also requires additional PEAR library packages, which will not be
    installed by default when building the current PHP source distribution. At
    present, these packages are:

        - Auth
        - HTML_Template_IT

    They can be obtained directly from the Web using the PEAR command line
    installer that comes with PHP:

        /opt/ilias/bin/pear install Auth
        /opt/ilias/bin/pear install HTML_Template_IT

    Important note: Some users experienced problems with the Auth module
	version 1.3.0r3 beta (white screen after login). If you have similar
	problems please install an older version of the Auth module:
	
        - download version 1.2.3 from http://pear.php.net/package/Auth
		- move to your download directory
        - /opt/ilias/bin/pear install ./Auth-1.2.3.tgz 

    The default PHP configuration file must be copied to /opt/ilias/config:

        cp php.ini-dist /opt/ilias/config/php.ini

    IMPORTANT: In PHP versions later than 4.1 the default value for the php.ini
    parameter 'register_globals' is set to 'off'. At the time being, ILIAS 2 will
    only work if 'register_globals' is enabled. For this reason you must change
    /opt/ilias/config/php.ini if you are using ILIAS 2:

        vi /opt/ilias/config/php.ini

    ILIAS 3 will also work with register_globals=Off.

    The parameter 'memory_limit' defines the maximum amount of memory a php
    script may consume. The default value of 8M maybe to low for some ILIAS
    scripts. We recommend to set this parameter to 40M.

    There are a few more settings in php.ini that might require modification:

    - session.gc_maxlifetime

      determines how many seconds an ILIAS session may be inactive before it is
      destroyed by the PHP session management. When setting this parameter
      please take into consideration that when working with the online editor
      tool an author may remain on an editor page for a much longer time than a
      normal user, e.g. when typing a longer text. However, for security reasons
      the value should not be set too high. We recommend to set it to 3600
      seconds (= 1 hour).

    - max_execution_time

      is the maximum execution time of each script in seconds. Some of the ILIAS
      scripts generating content for offline use may run longer than the default
      30 seconds. Depending on the performance of your server we recommend a
      value of up to 180 seconds.

    - post_max_size and upload_max_filesize

      determine the the maximum upload file size. Especially when using the
      file exchange functions in ILIAS the default value might be too low and
      should be corrected. 'post_max_size' should be at least as high as
      'upload_max_filesize'.

    - include_path

      make sure that the pear library is within your include path of php.
      if you followed the installation instruction above, just add
      '.:/opt/ilias/lib/pear'.


(d) Apache

    Configure & make:

        cd /opt/ilias/src/apache_1.3.29
        ./configure \
        --prefix=/opt/ilias \
        --activate-module=src/modules/php4/libphp4.a \
        --logfiledir=/opt/ilias/log \
        --runtimedir=/opt/ilias/log \
        --sysconfdir=/opt/ilias/config \
        --datadir=/opt/ilias/www
        make
        make install

    Link to startup script apachectl:

        cd /opt/ilias/bin
        chmod 744 apachectl
        cp apachectl /etc/rc.d/init.d/
        cd /etc/rc.d/rc3.d
        ln -s ../init.d/apachectl S70apachectl
        ln -s ../init.d/apachectl K70apachectl

    The directories containing the init script and the links to it may vary.
    Please check the default runlevel for your system in /etc/inittab. On
    Solaris systems the init scripts can usually be found in /etc/init.d, the
    links in the runlevel specific directories like /etc/rc3.d.

    If you are using RedHat Linux, the standard Apache start/stop script may not
    work properly. Please see APPENDIX A for a modified version using RedHat
    specific init functions. Use chkconfig --add to create runlevel specific
    links.

    Please change /opt/ilias/config/httpd.conf according to your needs, e.g. set
    a daemon user/group like 'wwwrun' (default: nobody/nobody) to run the httpd
    daemon. For PHP support include the following directives:

        DirectoryIndex index.html index.php

        AddType application/x-httpd-php .php
        AddType application/x-httpd-php .lang
        AddType application/x-httpd-php .inc

    Also please make sure that the name of your server is properly specified in
    httpd.conf. The 'ServerName' entry should either contain the DNS name of your
    server or its IP address. The line should be uncommented.

    IMPORTANT: All directories in your webspace ought to be secured properly, e.g.
    using .htaccess files. It is recommended to at least disable the directory
    option 'Indexes' in /opt/ilias/config/httpd.conf, so that someone accessing
    your web server cannot obtain listings of the files inside your web space
    directories.



2.4 Installing ILIAS

2.4.1 Installing ILIAS 2


(a) Installing the ILIAS 2 program files

    First of all extract the content of the ILIAS tarball into

        cd /opt/ilias/www/htdocs/
        tar -xzf /opt/ilias/src/tarballs/ilias-2.4.6.tar.gz

    IMPORTANT: Please make sure your webserver has write permission for at least
    the following subdirectories located in /opt/ilias/www/htdocs/ilias/:

        bilder/
        coursefiles/
        imagemaps/
        logos/
        low_cat/
        objects/
        plugins/
        sonderzeichen/
        tmp/

    Write access by the web server is also required for the directories under
    /opt/ilias/data/ (used for storing various data that shall not appear in
    the web space) and for /opt/ilias/log/ilias (used for saving ILIAS specific
    logfiles). Please set directory ownership and permissions accordingly.

    In most cases it will be sufficient to make the web server daemon user the
    owner of the entire ILIAS directory, its subdirectories and all other
    directories where data is stored by the web server. Example:

        chown -R wwwrun /opt/ilias/www/htdocs/ilias
        chown -R wwwrun /opt/ilias/data
        chown -R wwwrun /opt/ilias/log/ilias

    Depending on your MySQL setup it will probably be necessary to edit the
    include file 'ilias_db.inc', containing the settings for the ILIAS database.
    You may set the database name (in case you choose a different name for
    your ILIAS database in the subsequent step), host, user and password:

        cd /opt/ilias/www/htdocs/ilias/include
        vi ilias_db.inc


(b) Setting up the ILIAS database

    If not activated yet, please start the MySQL and Apache daemons, either by
    manually executing the appropriate init script using the parameter 'start'
    or by rebooting your system.

    For creating the ILIAS database you need to start the MySQL client. If a
    password has been set for the MySQL root account - which is strongly
    recommended -, use the -p option and your password to start the client.

    Create the ILIAS database:

        /opt/ilias/bin/mysql
        CREATE DATABASE ilias;
        exit

    Import the database template file:

        cd /opt/ilias/www/htdocs/ilias/sql/template
        /opt/ilias/bin/mysql ilias < ilias.database-template.sql

    If you are running a MySQL version below 3.23.x please remove 'TYPE=MyISAM'
    and 'TYPE=MyISAM PACK_KEYS=1' entries in all CREATE statements within the
    template file prior to importing it.

    After importing the template file it is necessary to run a migration script
    in order make sure that recent changes in the database structure are also
    incorporated into your database. For this purpose please access the file
    'http://www.yourserver.com/ilias/sql/migration/db_migration.php' with your
    web browser and identify yourself with the ILIAS superuser account:

        User ID: root
        Password: homer

    The migration process is performed immediately after authentication.
    Afterwards you may proceede to the next step.

    The database migration is especially important when UPGRADING to a new
    ILIAS release. In this case the database structure of your installation is
    likely to be out of date. Running the migration script will ensure that the
    new version of the ILIAS software works with your existing ILIAS database.


(c) Initial login

    After everything has been installed, accessing /ilias/index.php (or just the
    directory /ilias) with your web browser should bring up the ILIAS login
    screen. Please use the ILIAS superuser account for your first login:

        User ID: root
        Password: homer

    You will automatically enter the 'Basic System Settings' which are part of
    the ILIAS administration menu. There you will have to fill in some site
    specific data. The system's hostname, IP address, server port and software
    are obtained automatically. Please note that all path names in the system
    settings must be entered with a trailing slash.

        - Installation Name: a short name for your ILIAS installation.
        - Installation Info: a short system description.
        - Institution: the name of your institution.
        - HTTP Path: full URL of your ILIAS installation. The required format is
          the format 'http://host.domain/ilias-directory/'.
        - Absolute path: absolute filesystem path to your ILIAS directory.
        - Convert Path: path to the ImageMagick 'convert' tool.
        - Zip Path: location and name of your Zip compress utility.
        - Unzip Path: location and name of your Unzip uncompress untility.
        - Java Path: location of your Java environment (only in conjunction with
          the Babylon chat).
        - Babylon Path: location of your Babylon chat installation.
        - Logfile Path: directory for your ILIAS logfiles.
        - Session Logging: log all ILIAS sessions to a file in the directory
          specified under 'Logfile Path'.
        - Feedback Recipients: names of ILIAS users which shall receive messages
          sent through the feedback function. Multiple entries must be seperated
          by comma.
        - Error Recipients: the names of ILIAS users who shall receive error
          messages generated by ILIAS. Multiple entries must be seperated by
          comma.
        - By clicking on the check boxes you may activate/deactivate the
          following functions: Public Section, News, TeX Functions (requires
          the installation and configuration of TeX, please consult the ILIAS
          documentation under ./ilias/docs/html/index.html), mandatory Password
          Generation/Forwarding, Group File Sharing, Course Management System.
        - E-mail sender address for password forwarding.
        - ILIAS-NIC Server: the HTTP address of the ILIAS-NIC server. Default
          setting is 'http://homer.ilias.uni-koeln.de/ilias-nic/index.php'.
        - LDAP Settings (for further information please see the documentation
          under ./ilias/docs/html/index.html).
        - External Authentication (for further information please see the
          documentation under ./ilias/docs/html/index.html).
        - Contact Information: information to be sent to the ILIAS-NIC server.

    About ILIAS-NIC:

    Normally, when saving the Basic System Settings, some of the information
    above will automatically be sent to the ILIAS Network Information Center
    (ILIAS-NIC) at the University of Cologne: Hostname, IP address, installation
    name, installation info, HTTP path and contact information. In return your
    system receives a unique installation ID, which will allow data exchange
    between different ILIAS hosts as soon as this feature is implemented.

    All information provided will be treated confidentially and will not be
    disclosed to third parties. If for any reasons you dislike the idea of
    having this information transmitted to the ILIAS-NIC you can disable this
    function by clicking the check box 'Disable ILIAS-NIC connection'. All
    ILIAS functions except for the future networking extensions will work
    without setting the installation ID.

    If you disable the ILIAS-NIC connection on the first time installation,
    the installation ID will be set to '1', which is the default ID for all
    standalone ILIAS hosts. Afterwards you will not be able to reactivate
    the ILIAS-NIC function. If you want to obtain an installation ID at a
    later point, e.g. in order to participate in the future network of ILIAS
    systems, please contact ilias-info@uni-koeln.de in order to obtain an
    appropriate database patch.

    Depending on the configuration of your firewall or proxy server, problems
    may occur when establishing an HTTP connection to the ILIAS-NIC server.
    In this case it may also be necessary to disable the function and obtain
    the ID by sending a request to ilias-info@uni.koeln.de.

    After entering the Basic System Settings you should also check the following
    settings in the ILIAS administration:

        - System / Directories: set the location of the ILIAS data directories
          used for storing files and offline courses outside the web space.
        - System / Edit Desktop Links: if desired add Internet links to the
          user's personal desktop.
        - System / Library-Administration: Specify Internet links to online
          libraries and catalogs that shall appear in the ILIAS library section.
        - Courses / Categories: enter your course categories.
          Courses / Types of Material: Specify the types of learning material
          that shall appear in the meta data of the ILIAS editor. .
        - Courses / Overview Mode: select the course overview mode, that is the
          way the list of courses is presented to the user.
        - Template / Courses: Enable or disable course templates, e.g. for multi
          frame views.

    You may use the 'System / System Check' function in the ILIAS administration
    to check if your ILIAS system has been set up properly.

    Please CHANGE THE ILIAS ROOT PASSWORD on your first login!

    The ILIAS superuser account should only be used for system installation,
    upgrades and other special occasions, e.g. the creation of user accounts
    that belong to the Administration user group. Please create your own
    personal administrator account and use it for all regular administrative
    tasks.

    IMPORTANT: The script 'neuanmeldung.php' allows users to register themselves
    with status 'Learner' or 'Guest' in your ILIAS system. If you do not want
    anybody to self-register, you should remove the script from your web space
    or modify the it according to your needs.


(d) Settting up the chat server

    The file chatserver/install.txt explains how the chat server installation
    works.


2.4.2 Installing ILIAS 3

IMPORTANT: Please note that the following instructions are preliminary. Further
information will be provided with upcoming ILIAS 3 stable releases.

ILIAS 3 requires a Java Environment to be installed on the server for validation
of imported SCORM files against an XML scheme. The path to the Java installation
must be specified in the ILIAS 3 system settings.


(a) Installing the ILIAS 3 program files

    First extract the content of the ILIAS tarball into the web space directory:

        cd /opt/ilias/www/htdocs/
        tar -xzf /opt/ilias/src/tarballs/ilias-3.2.1.tar.gz

    Please make sure your webserver has write permission to the ILIAS3 web space
    and data directories and all their subdirectories. If your webserver daemon
    user is 'wwwrun' you can use these commands:

        chown -R wwwrun /opt/ilias/www/htdocs/ilias3
        chown -R wwwrun /opt/ilias/data


(b) Running the setup script

    Open the ILIAS 3 setup script in your web browser:

        http://www.yourserver.com/ilias3/setup/setup.php

    If all 'preliminaries' are fulfilled you may click on the [Installation]
    link at the end of the page and follow the instructions. The Path to the
    ILIAS data directory must be an absolut path i.e. it should start with
    "/", e.g. "/opt/ilias/data". The directory is used for data that does not
    need to be stored within the webspace.


(c) Initial login

    After all steps are passed you may proceed to the ILIAS 3 login,
    either using the [login] link or by accessing

        http://www.yourserver.com/ilias3/login.php

    Please use the ILIAS superuser account for your first login:

        User ID: root
        Password: homer

    In the Administration -> System Settings you may continue with the further
    configuration of your ILIAS system.

    Please CHANGE THE ILIAS ROOT PASSWORD on your first login!

(d) Setting up the user agreement form

    Every ILIAS user that registers to the system must confirm a user
    agreement. You should set up your own agreement text by editing the files
    that are provided in the agreement/ directory of ILIAS. You can add
	additional language versions by creating files following the format
	agreement_<langcode>.html.

(e) Settting up the chat server

    The file chat/chatserver/install.txt explains how the chat server
    installation works.

(f) Setting up cron jobs
    
    A cron job is an automated process that operates at predefined time
    intervals. As an example, you can set up a cron job that checks your ILIAS
    installation every day at 2:00 am for limited user accounts and sends an
    email notification to users which account expires within the next 2 weeks.

    How to enable this cron job?
    Please choose one of the following configurations. If possible use
    'server based configuration'.

    Server based configuration:

    - you need write access to the file /etc/crontab
    - add the following line in /etc/crontab
    0 2 * * * APACHEUSER /usr/bin/php ILIAS_ABSOLUTE_PATH/setup/cron.php > /dev/null

    To understand this even more, I'll show you what each of the values mean for
    the above cron tab.

    0                    Minutes after the hour
    2                    Hours of the day
    *                    Days of the month
    *                    Month of the year
    *                    WeekDays of the week
    APACHEUSER           The user which runs the cron job. Should be the same as
                         the apache user (wwwrun)
    ILIAS_ABSOLUTE_PATH  The absolute path to your ILIAS installation
    
    This example executes the script cron.php every night at 2 a clock.

    Web based configuration:

    - Edit the file ilias.ini.php in the main directory of your ILIAS
    installation. And add the following lines at the end of the file:
	
    [cron]
    web_enabled = "1"
    web_pass = "my_secret"
    
    Now you can point your browser to
    "http://www.your_ilias.de/setup/cron.php?web_pass=my_secret"
    
    Note: 
    cron.php can be executed only once a day. If you want to execute it again
    (e.g for testing), you have to remove the file 
	ILIAS_ABSOLUTE_PATH/setup/cron.lock.
    If logging is enabled in your ilias installation (see main setup) each
    started cron job writes messages in your log file.


2.5  Installing optional third-party software


(a) JpGraph graphics library for PHP

    The user tracking and statistics functions available in ILIAS 2 versions >=
    2.4.0_beta use the JpGraph library for displaying diagrams. The library
    is not part of the ILIAS distribution and needs to be installed seperately.
    It is available from:

        http://www.aditus.nu/jpgraph/

    Please note that JpGraph is not distributed under the GPL but under two
    different licenses: the QT Free License (QPL) that allows free use only for
    non-commercial purposes and the GpGraph Professional License that applies
    when JpGraph is used for commercial purposes. Depending on your use of
    ILIAS a licence fee for using JpGraph may be required.

    JpGraph is installed in the ILIAS web space directory in an own subdirectory
    named 'jpgraph':

        cd /opt/ilias/www/htdocs/ilias
        tar -xzf /opt/ilias/src/jpgraph-1.12.2.tar.gz
        mv ./jpgraph-1.12.2/ ./jpgrapj/

    After JpGraph has been properly installed in that location, the functions
    'Administrator Statistics' (in the ILIAS administration section) and 'Course
    Statistics' (on the Personal Desktop of course authors) will not only return
    the numerical values but also display statistical diagrams.


(b) Zend Optimizer

    As a PHP preprocessor the Zend Optimizer is used to improve the performance
    of the PHP interpreter. However, the performance increases that can be
    achieved by using it are rather limited. You may try it out though, since
    it usually does not have any negative effects either.

    Zend Optimizer is offered by Zend Technologies Ltd. free of charge, but it
    is not Open Source software. Different versions are available for Linux,
    Solaris and FreeBSD from:

        http://www.zend.com

    After unpacking the Zend Optimizer .tar.gz file you can start a shell script
    which guides you through the installation process.

    Having unpacked the appropriate .tar.gz file installation is fairly simple.
    The example shows the installation of the ZendOptimizer for Linux glibc 2.1:

        cd /opt/ilias/src
        tar -xzf tarballs/ZendOptimizer-2.1.0b-Linux_glibc21-i386.tar.gz
        cd /opt/ilias/src/ZendOptimizer-2.1.0b-Linux_glibc21-i386
        ./install.sh

    During the installation you will have to specify the following locations:

    Where to install Zend Optimizer: /opt/ilias/lib
    Location of your php.ini file:   /opt/ilias/config
    Apache configuration directory:  /opt/ilias/config
    Apache bin directory:            /opt/ilias/bin

    Your original php.ini file will be backed up in /opt/ilias/config/. The new
    php.ini file created by the ZendOptimizer installation script will be
    located in /opt/ilias/lib/etc/ with a link in /opt/ilias/config/ pointing
    to it.
		
    After restarting your Apache daemon you may find out if the ZendOptimizer is
    properly installed by checking the beginning of the 'PHP-Info' output in the
    ILIAS administration menu.


(c) ionCube PHP Accelerator

    The PHP Accelerator provides a caching for PHP scripts in the shared memory.
    Versions for various operating systems are available from:

        http://www.php-accelerator.co.uk/

    As opposed to the Zend Optimizer which offers only limited performance
    increases the PHP Accelerator can deliver significant acceleration. However,
    it does not run stable on every kind of server and usually requires some
    experimenting. We are still testing the PHP Accelerator and recommend it
    only to experienced users which monitor their servers closely. 

    Please note that PHP Accelerator and Zend Optimizer cannot be used in
    combination!
    
    Installation of the PHP Accelerator is rather straightforward. The example
    below shows the installation of version 1.3.3r2 for Linux. Basically you
    just copy the PHP Accelerator library and the administration tool to the
    appropriate directories under /opt/ilias and register it as a zend_extension
    in your php.ini file:
    
        cd /opt/ilias/src/
        tar xzf tarballs/php_accelerator-1.3.3r2_php-4.3.0_linux_i686*.tgz
        cd php_accelerator-1.3.3r2_php-4.3.0_linux_i686-glibc2.1.3
        cp php_accelerator_1.3.3r2.so /opt/ilias/lib/
        cp phpa_cache_admin /opt/ilias/bin/

    Open your php.ini file for editing, e.g. using 'vi' and insert the following
    lines:
    
     ; PHP Accelerator extension
     zend_extension="/opt/ilias/lib/php_accelerator_1.3.3r2.so"
 
    Please check the PHP Accelerator configuration documentation for further
    options. Especially you may want to enlarge the cache size. For a rather
    complex system like ILIAS the default size of 8 MB is rather low. We
    recommend a size of up to 32 MB, if your systems main memory size allows
    it, even more. Solaris users should read the 'solaris_notes' (included in
    the PHP Accelerator tarball) on how to configure shared memory.
 
    After restarting your Apache daemon you may find out if the PHP accelerator
    is in effect by checking the beginning of the 'PHP-Info' output in the ILIAS
    administration menu.


(d) Radius authentication (ILIAS 2 only)

    ILIAS currently supports a rudimentary Radius authentication in the user
    registration module using Unix PAM and a module for PAM support in PHP. The
    Radius authentication allows checking a Radius server for valid accounts
    before granting access to the ILIAS user registration. The following 
    optional components are required:

        - pam_auth: integrates basic Unix-PAM support into PHP4. It is available
          from http://www.math.ohio-state.edu/~ccunning/pam_auth.html. Currently
          only a modified version of pam_auth-0.1 (which also contains a minor
          bugfix, cf. pam_auth.c for details) seems to works properly with both,
          pam_radius_auth and PHP 4.3.x. It is available from the ILIAS web site
          http://www.ilias.uni-koeln.de/download/xsrc/pam_auth-0.1_ilias.tar.gz

        - pam_radius_auth-1.1.3: a module for Radius authentication via Unix-
          PAM. It is available from: http://www.freeradius.org/pam_radius_auth

    Before compiling PHP, the modified version of pam_auth must be added to the
    PHP source code. Please note that PHP requires libtool 1.4.3 or newer
    installed in order to run buildconf:

         cd /opt/ilias/src
         cp -r pam_auth /opt/ilias/src/php-4.3.6/ext/
         cd /opt/ilias/src/php-4.3.6
         ./buildconf --force

    When compiling PHP add this configure directive:

         --with-pam_auth

    Create the file /etc/pam.d/php containing this line:

         auth     required     /lib/security/pam_radius_auth.so

    If desired 'debug' may be added to the end of the line. Debug messages from
    the PAM Radius module will then be written to /var/log/messages.

    Compile pam_radius_auth:

         cd /opt/ilias/src/pam_radius-1.3.11
         make

    Copy pam_radius_auth to the appropriate library directory:

         cp pam_radius_auth.so /lib/security/pam_radius_auth.so

    Create file /etc/raddb/server with the following entry:

         servername:port                secret    timeout

         Example:

         mail1.rrz.uni-koeln.de:1645    xyz    60

    According to the pam_radius_auth documentation /etc/raddb/server and its
    directory need to be secure, accessible only by root. However, this does not
    work when using tha pam_radius_auth module together with PHP/pam_auth. As a
    workaround, permissions may be set to allow read access for the httpd daemon
    user. Please be aware of the resulting security gap.

    In ILIAS, Radius support must be enabled in 'Administration / Modules'.

    IMPORTANT: Please note that the ILIAS Radius authentication should only be
    used with secure connections. At least the ILIAS registration script
    (neuanmeldung.php) should be secured with SSL encryption. Otherwise the
    usernames/passwords of the Radius accounts to be validated might easily
    be intercepted when being sent via http.




3.  S O F T W A R E  U P D A T E S


3.1  Updating ILIAS 2

BACKUP YOUR ILIAS MYSQL DATABASE, THE ENTIRE CONTENTS OF THE ILIAS WEB DIRECTORY
AND THE ILIAS DATA DIRECTORIES BEFORE DOING ANY CHANGES!

IMPORTANT: With ILIAS release 2.3.8 some recommendations in this document have
changed:

    - /opt/ilias/data/ was formerly /opt/ilias/iliasdata/
    - /opt/ilias/log/ was formerly /opt/ilias/logfiles/
    - the third-party software packages Apache, MySQL, PHP and ImageMagick now
      have the same base directory /opt/ilias/ instead of being installed in
      separate base directories under /opt/ilias/.
    - /opt/ilias/log/ilias/ has been introduced as directory for ILIAS logfiles.
      Write access must be granted to the web server daemon user.

Please take this into consideration when upgrading from an old installation and
adapt the path names if necessary. If you decide to rename your existing
directories make sure that the ILIAS system settings and all configuration files
reflect the changes.

At the time being no installation script is available for updating ILIAS. For
this reason the ILIAS script files must be updated manually. In the following
steps it it assumed that your existing ILIAS installation is located in
/opt/ilias/www/htdocs/ilias/ while the contents of the ILIAS distribution tar
file lies in /tmp/. If the locations differ on your system you may need to adapt
the commands used in the following.

Some files and directories will be replaced in the update process. They must be
removed from your ILIAS web directory. If you keep any additional files or data
that is worth to be saved in one of these directories please take all necessary
precautions. This is especially important if you have modified parts of the
ILIAS source code, the language files in ./lang/ or the course templates in
./templates/. It is also recommended to save the file ilias_db.inc located in
the  directory ./include/ which contains settings sepcific to your MySQL
database. After installing the new ILIAS release you may easily restore the it.

    cd /opt/ilias/www/htdocs/ilias
    rm *
    rm -r convert docs help ilias_hilfe images include lang modules sql
    rm -r syntax_highlight

You may ignore any 'no such file or directory' errors because depending on
your current ILIAS installation some of the directories above may not exist on
your system.

Then extract the ILIAS distribution tar file to /tmp/ (or any other directory of
your choice). Do not simply overwrite the 'ilias' directory in your webspace!
Example:

    cd /tmp
    tar -xzf /opt/ilias/src/tarballs/ilias-2.4.6.tar.gz

After extracting the files you will find a newly created subdirectory 'ilias' in
your tmp/ directory. Depending on the ILIAS version you are replacing you must
copy various files and directories to your ILIAS web directory:

Migrating from version 2.x.x:

    cd /tmp/ilias
    cp -p * /opt/ilias/www/htdocs/ilias/
    cp -rp include lang images sql help templates /opt/ilias/www/htdocs/ilias/
    cp -rp docs syntax_highlight modules tmp /opt/ilias/www/htdocs/ilias/
    cp -rp convert /opt/ilias/www/htdocs/ilias/
    mkdir /opt/ilias/data
    mkdir /opt/ilias/data/offline
    mkdir /opt/ilias/data/files
    mkdir /opt/ilias/data/import
    mkdir /opt/ilias/data/export
    mkdir /opt/ilias/log/ilias

Migrating from version 1.9.x / 1.8.x /  1.7.x:

    cd /tmp/ilias
    cp -p * /opt/ilias/www/htdocs/ilias/
    cp -p include/* /opt/ilias/www/htdocs/ilias/include/
    cp -p lang/* /opt/ilias/www/htdocs/ilias/lang/
    cp -rp include lang images sql help templates /opt/ilias/www/htdocs/ilias/
    cp -rp docs syntax_highlight modules tmp /opt/ilias/www/htdocs/ilias/
    cp -rp logos low_cat coursefiles convert /opt/ilias/www/htdocs/ilias/
    cd html
    cp -p login.html logout.html /opt/ilias/www/htdocs/ilias/html/
    mkdir /opt/ilias/data
    mkdir /opt/ilias/data/offline
    mkdir /opt/ilias/data/files
    mkdir /opt/ilias/data/import
    mkdir /opt/ilias/data/export
    mkdir /opt/ilias/log/ilias

Please ignore any 'File exists' error messages. After all files have been copied
you may remove /tmp/ilias/.

The directories under /opt/ilias/data/ are used for storing various kinds of
data, e.g. files in group folders. It is located outside the web space but the
web server daemon user must have read/write access to it. Please set file
ownership and permissions accordingly. Please also register the directories in
the ILIAS administration (-> 'System / Directories').

/opt/ilias/data/offline/ may be used to store offline courses available for
download. They were formerly saved in /opt/ilias/www/htdocs/ilias/offline/ and
should be moved to the new location. The original directory may be removed
afterwards. Please set file ownership and permissions so that the web server
daemon can still access the files.

After installing a new ILIAS release you must run the database migration script,
so that all changes in the database structure are also applied to your database.
To do so, access the file

    'http://www.yourserver.com/ilias/sql/migration/db_migration.php'

with your web browser and identify yourself using the ILIAS 'root' account and
password. The migration process is performed immediately after authentication.
Depending on the size of your database this may take a while.

Please check section 2.4.1 (Installing ILIAS 2), c) (Inital login) for new
options in the ILIAS system settings.


3.2  Updating ILIAS 3

THIS INSTRUCTIONS EXPLAIN HOW TO UPDATE FROM ANY ILIAS 3.0.0 beta version or
higher to ILIAS 3.2.1.

BACKUP YOUR ILIAS MYSQL DATABASE, THE ENTIRE CONTENTS OF THE ILIAS WEB DIRECTORY
AND THE ILIAS DATA DIRECTORIES BEFORE DOING ANY CHANGES!

We recommend not to update from an any alpha version of ILIAS 3 because this
may cause ambiguous errors in the future. Please setup any beta, release
candidate or final version of ILIAS 3 from scratch.

At the time being no installation script is available for updating ILIAS 3. For
this reason the ILIAS script files must be updated manually. In the following
steps it it assumed that your existing ILIAS 3 installation is located in
/opt/ilias/www/htdocs/ilias/ while the contents of the ILIAS distribution tar
file lies in /tmp/. If the locations differ on your system you may need to adapt
the commands used in the following.

Some files and directories will be replaced in the update process. They must be
removed from your ILIAS web directory. If you keep any additional files or data
that is worth to be saved in one of these directories please take all necessary
precautions. This is especially important if you have modified parts of the
ILIAS source code, the language files in ./lang/, any template files in
the templates/ subdirectories and your user agreement files in the agreement
directory. It is also recommended to save the files ilias.ini.php located in the
main ILIAS directory which contains individual settings of your ILIAS
installation and chat/chatserver/server.ini which stores the setting for the
ilias chat server. After installing the new ILIAS release you may easily restore
these files.

    cd /opt/ilias/www/htdocs/ilias
    rm *.php *.xml *.dtd *.css
    rm -r classes content css docs images include java lang layouts
    rm -r modules setup sql templates xml assessment chat tracking
    rm -r survey syntax_highlight course payment

You may ignore any 'no such file or directory' errors because depending on
your current ILIAS installation some of the directories above may not exist on
your system.

Then extract the ILIAS distribution tar file to /tmp/ (or any other directory of
your choice). Do not simply overwrite the 'ilias' directory in your webspace!
Example:

    cd /tmp
    tar -xzf /opt/ilias/src/tarballs/ilias-3.2.1.tar.gz

After extracting the files you will find a newly created subdirectory 'ilias3' in
your tmp/ directory. Depending on the ILIAS version you are replacing you must
copy various files and directories to your ILIAS web directory:

    cd /tmp/ilias3
    cp -p * /opt/ilias/www/htdocs/ilias/
    cp -rp assessment chat classes content course /opt/ilias/www/htdocs/ilias/
    cp -rp css docs images include java lang layouts /opt/ilias/www/htdocs/ilias/
    cp -rp modules payment setup sql survey /opt/ilias/www/htdocs/ilias/
    cp -rp syntax_highlight templates tracking xml /opt/ilias/www/htdocs/ilias/

Please ignore any 'File exists' error messages. After all files have been copied
you may remove /tmp/ilias/.

Copy your saved ilias.ini.php file to /opt/ilias/www/htdocs/ilias/.

After installing a new ILIAS 3 release you must run the setup script
'http://www.yourserver.com/ilias/setup/setup.php' and update the database of all
your clients. Select "Details" for every client in the client list and click on
the "Database" button. Depending on the size of your database the update process
may take a while. Enter your clients and execute the "Refresh Languages" command
in the language administration of the system settings ("Administration" ->
"System Settings" -> "Languages" -> "Refresh Languages").


3.3  Updating third-party software

Because the main third-party software components interact in different ways,
updating one of these components usually requires a complete re-installation
as described in 'First Time Installation'.

MySQL, PHP and the Apache Webserver can normally be re-installed at any time
while retaining the original system configuration (configuration files will
not be modified). Before doing so make sure you have backed up your system.
Then clean up your /opt/ilias/src/ directory and extract the new source files
to this location. Configure and compile the software with the directives used
n the inital installation process and in the same order, starting with MySQL
and ending with the Apache server.



A P P E N D I X  A: Note on using Apache 2

At the time being Apache 2 is not yet recommended for production use with PHP.
However, we are already testing ILIAS with Apache 2. If you like to try out
Apache 2 for your ILIAS system, please proceed as follows:

    - Omit the preparatory step and directly compile and install Apache 2 as
      described in section '2.3.2 - (d) Apache'" but replace the configure
      directive '--activate-module=src/modules/php4/libphp4.a' by '--enable-so'.

    - Add this line to the Apache configuration file httpd.conf, so that PHP
      is loaded as a Dynamic Shared Object (DSO):

          LoadModule php4_module modules/libphp4.so

    - Build PHP as described in section '2.3.2 - (c) PHP' but replace the
      configure directive '--with-apache=/opt/ilias/src/apache_1.3.29' with
      '--with-apxs2=/opt/ilias/bin/apxs'.

    - Starting the Apache 2 daemon should now also invoke the PHP module.



A P P E N D I X  B: MySQL and Apache init scripts for RedHat


(1) mysql - MySQL init script for RedHat Linux -----

#!/bin/sh

# chkconfig: 345 72 72
# description: Mysql is a SQL (Structured Query Language) database server
#
# Source function library.
. /etc/rc.d/init.d/functions

mode=$1
PATH=/sbin:/bin:/usr/bin:/usr/sbin
set `id`
bindir=/opt/ilias/bin
datadir=/opt/ilias/mysqldata
pid_file=/opt/ilias/mysqldata/mysqld.pid

mysql_daemon_user=mysql    # Run mysqld as this user.

if [ $1 != "uid=0(root)" ]; then
    echo "$0: this script must be run as root ... fatal error"
    exit 1
fi

case "$mode" in
'start')
    # Start deamon
    echo -n "Starting mysqld: "
    daemon $bindir/safe_mysqld --datadir=$datadir --user=$mysql_daemon_user &
    RETVAL=$?
    echo
    [ $RETVAL -eq 0 ] && touch /var/lock/subsys/mysql
    ;;
'status')
    status mysqld
    ;;
'restart')
    $0 stop
    $0 start
        ;;
'stop')
    # Stop deamon
    echo -n "Shutting down mysqld: "
    #mysqladmin shutdown
    killproc mysqld 2>/dev/null
    RETVAL=$?
    echo
    [ $RETVAL -eq 0 ] && rm -f /var/lock/subsys/mysql
    ;;
		
*)
    echo "usage: $0 start|status|restart|stop"
    exit 1
    ;;

esac


-----


(2) httpd - Apache init script for RedHat linuy -----

#!/bin/sh
#
# Startup script for the Apache Web Server
#
# chkconfig: 345 85 15
# description: Apache is a World Wide Web server.  It is used to serve \
#	       HTML files and CGI.
# processname: httpd
# pidfile: /opt/ilias/log/httpd.pid
# config: /opt/ilias/config/access.conf
# config: /opt/ilias/config/httpd.conf
# config: /opt/ilias/config/srm.conf


# Source function library.
. /etc/rc.d/init.d/functions

bindir=/opt/ilias/bin
pid_file=/opt/ilias/httpd/log/httpd.pid

# See how we were called.
case "$1" in
start)
    echo -n "Starting httpd: "
    daemon $bindir/httpd
    echo
    touch /var/lock/subsys/httpd
	;;
stop)
    echo -n "Shutting down http: "
    killproc httpd
    echo
    rm -f /var/lock/subsys/httpd
    rm -f $pid_file
    ;;
status)
    status httpd
    ;;
restart)
    $0 stop
    $0 start
    ;;
reload)
    echo -n "Reloading httpd: "
    killproc httpd -HUP
    echo
    ;;
*)
    echo "Usage: $0 {start|stop|restart|reload|status}"
    exit 1
esac

exit 0

-----
